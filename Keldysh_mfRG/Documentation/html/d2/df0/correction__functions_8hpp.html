<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SIAM-Keldysh-mfRG: correction_functions.hpp File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">SIAM-Keldysh-mfRG
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d2/df0/correction__functions_8hpp.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">correction_functions.hpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="../../d7/d59/data__structures_8hpp_source.html">../data_structures.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d1/d2d/vertex_8hpp_source.html">../correlation_functions/four_point/vertex.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d1/df8/master__parameters_8hpp_source.html">../parameters/master_parameters.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d0/d3f/util_8hpp_source.html">../utilities/util.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dd/dea/bubble__corrections_8hpp_source.html">bubble_corrections.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d0/d0e/loop__corrections_8hpp_source.html">loop_corrections.hpp</a>&quot;</code><br />
<code>#include &lt;cmath&gt;</code><br />
<code>#include &quot;<a class="el" href="../../dd/d1f/integrator_8hpp_source.html">../integrator/integrator.hpp</a>&quot;</code><br />
</div>
<p><a href="../../d2/df0/correction__functions_8hpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa927c9725b69dc5c5cb4626e7c10ad17" id="r_aa927c9725b69dc5c5cb4626e7c10ad17"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q , <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> <a class="el" href="../../d1/d9f/classIntegrand.html">Integrand</a> &gt; </td></tr>
<tr class="memitem:aa927c9725b69dc5c5cb4626e7c10ad17"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">auto</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#aa927c9725b69dc5c5cb4626e7c10ad17">asymp_corrections_bubble_via_quadrature</a> (<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d1/d9f/classIntegrand.html">Integrand</a> &amp;integrand, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> double vmin, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> double vmax) -&gt; Q</td></tr>
<tr class="memdesc:aa927c9725b69dc5c5cb4626e7c10ad17"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes tails via quadrature routine.  <br /></td></tr>
<tr class="separator:aa927c9725b69dc5c5cb4626e7c10ad17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac617baabe863b35d7652e62c345a3400" id="r_ac617baabe863b35d7652e62c345a3400"><td class="memTemplParams" colspan="2">template&lt;char channel, int spin, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q , <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">vertexType_1</a> , <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">vertexType_2</a> &gt; </td></tr>
<tr class="memitem:ac617baabe863b35d7652e62c345a3400"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">auto</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#ac617baabe863b35d7652e62c345a3400">asymp_corrections_bubble</a> (<a class="el" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6">K_class</a> <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">k</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">vertexType_1</a> &amp;vertex1, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">vertexType_2</a> &amp;vertex2, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d2/d34/classPropagator.html">Propagator</a>&lt; Q &gt; &amp;G, double vmin, double vmax, <a class="el" href="../../d1/df8/master__parameters_8hpp.html#a509f74e58953ffbd5c00435ce600cd3e">freqType</a> w, <a class="el" href="../../d1/df8/master__parameters_8hpp.html#a509f74e58953ffbd5c00435ce600cd3e">freqType</a> v, <a class="el" href="../../d1/df8/master__parameters_8hpp.html#a509f74e58953ffbd5c00435ce600cd3e">freqType</a> vp, int <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">i0_in</a>, int i2, int i_in, <a class="el" href="../../d9/db9/classbool.html">bool</a> diff) -&gt; Q</td></tr>
<tr class="separator:ac617baabe863b35d7652e62c345a3400"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad39986be0f18f26c38ab2fe8016d5b0a" id="r_ad39986be0f18f26c38ab2fe8016d5b0a"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q , <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> <a class="el" href="../../d7/d59/data__structures_8hpp.html#a3931ffa7cd4a0005be369b34231a4b84">vertexType</a> &gt; </td></tr>
<tr class="memitem:ad39986be0f18f26c38ab2fe8016d5b0a"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">auto</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#ad39986be0f18f26c38ab2fe8016d5b0a">asymp_corrections_loop</a> (<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d7/d59/data__structures_8hpp.html#a3931ffa7cd4a0005be369b34231a4b84">vertexType</a> &amp;vertex, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d2/d34/classPropagator.html">Propagator</a>&lt; Q &gt; &amp;G, double vmin, double vmax, double v, int iK, int <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">ispin</a>, int i_in, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d9/db9/classbool.html">bool</a> <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">all_spins</a>) -&gt; Q</td></tr>
<tr class="separator:ad39986be0f18f26c38ab2fe8016d5b0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ac617baabe863b35d7652e62c345a3400" name="ac617baabe863b35d7652e62c345a3400"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac617baabe863b35d7652e62c345a3400">&#9670;&#160;</a></span>asymp_corrections_bubble()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;char channel, int spin, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q , <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">vertexType_1</a> , <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">vertexType_2</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">auto</a> asymp_corrections_bubble </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6">K_class</a></td>          <td class="paramname"><span class="paramname"><em>k</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">vertexType_1</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>vertex1</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">vertexType_2</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>vertex2</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d2/d34/classPropagator.html">Propagator</a>&lt; Q &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>G</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>vmin</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>vmax</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/df8/master__parameters_8hpp.html#a509f74e58953ffbd5c00435ce600cd3e">freqType</a></td>          <td class="paramname"><span class="paramname"><em>w</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/df8/master__parameters_8hpp.html#a509f74e58953ffbd5c00435ce600cd3e">freqType</a></td>          <td class="paramname"><span class="paramname"><em>v</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/df8/master__parameters_8hpp.html#a509f74e58953ffbd5c00435ce600cd3e">freqType</a></td>          <td class="paramname"><span class="paramname"><em>vp</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>i0_in</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>i2</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>i_in</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/db9/classbool.html">bool</a></td>          <td class="paramname"><span class="paramname"><em>diff</em></span>&#160;) -&gt; Q </td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the analytical result for the asymptotic tails of the bubble integral, assuming the self-energy to be decayed to the Hartree value. The full result is Gamma_L * I_tails(vmin, vmax) * Gamma_R, where vmax/vmin are the upper/lower limits of the numerically evaluated integral, I_tails is the channel-dependent helper function defined above, containing the result of the analytical integration, and Gamma_L, Gamma_R are the left/right vertices, with appropriately chosen arguments.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Q</td><td>: Return data type (comp or double) </td></tr>
    <tr><td class="paramname">symmetry_left</td><td>: Symmetry type of the left vertex </td></tr>
    <tr><td class="paramname">symmetry_right</td><td>: Symmetry type of the right vertex </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">k</td><td>: Diagrammatic class (k1, k2, k3) to which the result contributes </td></tr>
    <tr><td class="paramname">vertex1</td><td>: Left vertex </td></tr>
    <tr><td class="paramname">vertex2</td><td>: Right vertex </td></tr>
    <tr><td class="paramname">G</td><td>: <a class="el" href="../../d8/d6e/classBubble.html" title="Class combining two propagators, either GG or GS+SG.">Bubble</a> propagator (needed for the Hartree selfenergy and the flow parameter Lambda) </td></tr>
    <tr><td class="paramname">vmin</td><td>: Lower limit of the numerically evaluated integral in bubble_function </td></tr>
    <tr><td class="paramname">vmax</td><td>: Upper limit of the numerically evaluated integral in bubble_function </td></tr>
    <tr><td class="paramname">w</td><td>: External bosonic frequency </td></tr>
    <tr><td class="paramname">v</td><td>: External fermionic frequency (only needed for K2, K3) </td></tr>
    <tr><td class="paramname">vp</td><td>: External fermionic frequency (only needed for K3) </td></tr>
    <tr><td class="paramname">i0_in</td><td>: External Keldysh index input. Must be converted to iK in 0...15 </td></tr>
    <tr><td class="paramname">i2</td><td>: <a class="el" href="../../d8/d6e/classBubble.html" title="Class combining two propagators, either GG or GS+SG.">Bubble</a> Keldysh index </td></tr>
    <tr><td class="paramname">i_in</td><td>: Internal index </td></tr>
    <tr><td class="paramname">channel</td><td>: Diagrammatic channel </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: Value of the asymptotic correction </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/df0/correction__functions_8hpp_source.html#l00054">54</a> of file <a class="el" href="../../d2/df0/correction__functions_8hpp_source.html">correction_functions.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   59</span>                                                                                                                {</div>
<div class="line"><span class="lineno">   60</span> </div>
<div class="line"><span class="lineno">   61</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="../../d9/d59/namespacegetIntegrand.html#a8c9600ab594068787054475dc580f6c0">i0</a>;                 <span class="comment">// external Keldysh index (in the range [0,...,15])</span></div>
<div class="line"><span class="lineno">   62</span>    <span class="keywordtype">double</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">eta_1</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">eta_2</a>;    <span class="comment">// +1/-1 distinguish retarded/advanced components of first and second propagator</span></div>
<div class="line"><span class="lineno">   63</span>    Q <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_H</a> = G.<a class="code hl_variable" href="../../d2/d34/classPropagator.html#a3c6ea2e6484393ae6b8dae0e93b52ada">selfenergy</a>.asymp_val_R;             <span class="comment">// Hartree self-energy</span></div>
<div class="line"><span class="lineno">   64</span>    <span class="keywordtype">double</span> Delta;</div>
<div class="line"><span class="lineno">   65</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="../../d1/df8/master__parameters_8hpp.html#ac12997fa537ec8cbf0f69bf8228cc2a0">REG</a>==2) {</div>
<div class="line"><span class="lineno">   66</span>        Delta = (G.<a class="code hl_variable" href="../../d2/d34/classPropagator.html#aa1d72170fcc752ac7164f4cbb31ef281">Gamma</a> + G.<a class="code hl_variable" href="../../d2/d34/classPropagator.html#ad14d8669e7e3b6934df9ba2fa6168a75">Lambda</a>) / 2.;       <span class="comment">// Hybridization (~ flow parameter) at which the bubble is evaluated</span></div>
<div class="line"><span class="lineno">   67</span>    }</div>
<div class="line"><span class="lineno">   68</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   69</span>        Delta = G.<a class="code hl_variable" href="../../d2/d34/classPropagator.html#aa1d72170fcc752ac7164f4cbb31ef281">Gamma</a> / 2.;                    <span class="comment">// Hybridization (~ flow parameter) at which the bubble is evaluated</span></div>
<div class="line"><span class="lineno">   70</span>    }</div>
<div class="line"><span class="lineno">   71</span>    Q <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res</a>{}, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_Vhat</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_Vhat</a>;  <span class="comment">// define result and vertex values</span></div>
<div class="line"><span class="lineno">   72</span> </div>
<div class="line"><span class="lineno">   73</span>    std::vector&lt;int&gt; <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">indices</a> = {0, 0}; <span class="comment">// Already right for Matsubara</span></div>
<div class="line"><span class="lineno">   74</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/df8/master__parameters_8hpp.html#afab5195e3ffff420d211040e5672fcbe">KELDYSH</a>){</div>
<div class="line"><span class="lineno">   75</span>        <span class="comment">// initialize the retarded/advanced flags depending on the bubble Keldysh index i2</span></div>
<div class="line"><span class="lineno">   76</span>        <span class="keywordflow">switch</span> (i2) {</div>
<div class="line"><span class="lineno">   77</span>            <span class="comment">// eta = +1  =&gt; Retarded</span></div>
<div class="line"><span class="lineno">   78</span>            <span class="comment">// eta = -1  =&gt; Advanced</span></div>
<div class="line"><span class="lineno">   79</span>            <span class="keywordflow">case</span> 3:     <span class="comment">//AA</span></div>
<div class="line"><span class="lineno">   80</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">eta_1</a> = -1.;</div>
<div class="line"><span class="lineno">   81</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">eta_2</a> = -1.;</div>
<div class="line"><span class="lineno">   82</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   83</span>            <span class="keywordflow">case</span> 6:     <span class="comment">//AR</span></div>
<div class="line"><span class="lineno">   84</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">eta_1</a> = -1.;</div>
<div class="line"><span class="lineno">   85</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">eta_2</a> =  1.;</div>
<div class="line"><span class="lineno">   86</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   87</span>            <span class="keywordflow">case</span> 9:     <span class="comment">//RA</span></div>
<div class="line"><span class="lineno">   88</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">eta_1</a> =  1.;</div>
<div class="line"><span class="lineno">   89</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">eta_2</a> = -1.;</div>
<div class="line"><span class="lineno">   90</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   91</span>            <span class="keywordflow">case</span> 12:    <span class="comment">//RR</span></div>
<div class="line"><span class="lineno">   92</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">eta_1</a> = 1.;</div>
<div class="line"><span class="lineno">   93</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">eta_2</a> = 1.;</div>
<div class="line"><span class="lineno">   94</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   95</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">   96</span>                <span class="keywordflow">return</span> 0.;</div>
<div class="line"><span class="lineno">   97</span>        }</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span><span class="preprocessor">#if not DEBUG_SYMMETRIES</span></div>
<div class="line"><span class="lineno">  100</span>        <span class="comment">// convert the input external Keldysh index from reduced set to [0,...,15]</span></div>
<div class="line"><span class="lineno">  101</span>        <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  102</span><span class="comment">        switch (k) {</span></div>
<div class="line"><span class="lineno">  103</span><span class="comment">            case k1:</span></div>
<div class="line"><span class="lineno">  104</span><span class="comment">                switch (channel) {</span></div>
<div class="line"><span class="lineno">  105</span><span class="comment">                    case &#39;a&#39;:</span></div>
<div class="line"><span class="lineno">  106</span><span class="comment">                        i0 = non_zero_Keldysh_K1a[i0_in];</span></div>
<div class="line"><span class="lineno">  107</span><span class="comment">                        break;</span></div>
<div class="line"><span class="lineno">  108</span><span class="comment">                    case &#39;p&#39;:</span></div>
<div class="line"><span class="lineno">  109</span><span class="comment">                        i0 = non_zero_Keldysh_K1p[i0_in];</span></div>
<div class="line"><span class="lineno">  110</span><span class="comment">                        break;</span></div>
<div class="line"><span class="lineno">  111</span><span class="comment">                    case &#39;t&#39;:</span></div>
<div class="line"><span class="lineno">  112</span><span class="comment">                        i0 = non_zero_Keldysh_K1t[i0_in];</span></div>
<div class="line"><span class="lineno">  113</span><span class="comment">                        break;</span></div>
<div class="line"><span class="lineno">  114</span><span class="comment">                    default:;</span></div>
<div class="line"><span class="lineno">  115</span><span class="comment">                }</span></div>
<div class="line"><span class="lineno">  116</span><span class="comment">                break;</span></div>
<div class="line"><span class="lineno">  117</span><span class="comment">            case k2:</span></div>
<div class="line"><span class="lineno">  118</span><span class="comment">                switch (channel) {</span></div>
<div class="line"><span class="lineno">  119</span><span class="comment">                    case &#39;a&#39;:</span></div>
<div class="line"><span class="lineno">  120</span><span class="comment">                        i0 = non_zero_Keldysh_K2a[i0_in];</span></div>
<div class="line"><span class="lineno">  121</span><span class="comment">                        break;</span></div>
<div class="line"><span class="lineno">  122</span><span class="comment">                    case &#39;p&#39;:</span></div>
<div class="line"><span class="lineno">  123</span><span class="comment">                        i0 = non_zero_Keldysh_K2p[i0_in];</span></div>
<div class="line"><span class="lineno">  124</span><span class="comment">                        break;</span></div>
<div class="line"><span class="lineno">  125</span><span class="comment">                    case &#39;t&#39;:</span></div>
<div class="line"><span class="lineno">  126</span><span class="comment">                        i0 = non_zero_Keldysh_K2t[i0_in];</span></div>
<div class="line"><span class="lineno">  127</span><span class="comment">                        break;</span></div>
<div class="line"><span class="lineno">  128</span><span class="comment">                    default:;</span></div>
<div class="line"><span class="lineno">  129</span><span class="comment">                }</span></div>
<div class="line"><span class="lineno">  130</span><span class="comment">                break;</span></div>
<div class="line"><span class="lineno">  131</span><span class="comment">            case k3:</span></div>
<div class="line"><span class="lineno">  132</span><span class="comment">                i0 = non_zero_Keldysh_K3[i0_in];</span></div>
<div class="line"><span class="lineno">  133</span><span class="comment">                break;</span></div>
<div class="line"><span class="lineno">  134</span><span class="comment">            default:;</span></div>
<div class="line"><span class="lineno">  135</span><span class="comment">        }</span></div>
<div class="line"><span class="lineno">  136</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno">  137</span>        <a class="code hl_variable" href="../../d9/d59/namespacegetIntegrand.html#a8c9600ab594068787054475dc580f6c0">i0</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">i0_in</a>;</div>
<div class="line"><span class="lineno">  138</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  139</span>    <a class="code hl_variable" href="../../d9/d59/namespacegetIntegrand.html#a8c9600ab594068787054475dc580f6c0">i0</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">i0_in</a>;</div>
<div class="line"><span class="lineno">  140</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  141</span> </div>
<div class="line"><span class="lineno">  142</span>        <span class="comment">// determine the Keldysh indices of left and right vertex</span></div>
<div class="line"><span class="lineno">  143</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">indices</a> = <a class="code hl_function" href="../../d4/de0/Keldysh__symmetries_8c_09_09.html#a8ce5883bf24e8dbb17eb7e2cf3c51afe">indices_sum</a>(i0, i2, channel);</div>
<div class="line"><span class="lineno">  144</span>    }</div>
<div class="line"><span class="lineno">  145</span> </div>
<div class="line"><span class="lineno">  146</span>    <span class="comment">// Define the arguments of left and right vertices. The value of the integration variable is set to 10*vmin, which</span></div>
<div class="line"><span class="lineno">  147</span>    <span class="comment">// lies outside the vertex frequency grid and should thus be equivalent to +/- infinity.</span></div>
<div class="line"><span class="lineno">  148</span>    <a class="code hl_struct" href="../../d2/db2/structVertexInput.html">VertexInput</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_l</a> (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">indices</a>[0], <a class="code hl_define" href="../../d1/df8/master__parameters_8hpp.html#a8e29bcd96e548a3249a0a93917debc8b">SBE_DECOMPOSITION</a> ? 0 : <a class="code hl_enumvalue" href="../../db/d58/namespacemy__defs_1_1K1.html#ae0dde289d1bfdb687324024b44a56cb3a0e8f8c5700d73a66191a72ea5eba2082">spin</a>, <a class="code hl_variable" href="../../d9/d59/namespacegetIntegrand.html#ac27f31b5826d872c73024a5fa645598f">w</a>, <a class="code hl_variable" href="../../d9/d59/namespacegetIntegrand.html#a8de2c1f4f0e95b0891bbf53c7585193c">v</a>, 10*vmin+1, <a class="code hl_variable" href="../../d9/d59/namespacegetIntegrand.html#a9e34c20b9b4b3f9db34da5515e091c7a">i_in</a>, <a class="code hl_variable" href="../../d9/d59/namespacegetIntegrand.html#affe557b99ce21081450f9a33337f29ab">channel</a>);</div>
<div class="line"><span class="lineno">  149</span>    <a class="code hl_struct" href="../../d2/db2/structVertexInput.html">VertexInput</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_r</a> (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">indices</a>[1], <a class="code hl_define" href="../../d1/df8/master__parameters_8hpp.html#a8e29bcd96e548a3249a0a93917debc8b">SBE_DECOMPOSITION</a> ? 0 : <a class="code hl_enumvalue" href="../../db/d58/namespacemy__defs_1_1K1.html#ae0dde289d1bfdb687324024b44a56cb3a0e8f8c5700d73a66191a72ea5eba2082">spin</a>, <a class="code hl_variable" href="../../d9/d59/namespacegetIntegrand.html#ac27f31b5826d872c73024a5fa645598f">w</a>, 10*vmin+1, <a class="code hl_variable" href="../../d9/d59/namespacegetIntegrand.html#a4e095fa5805b564f2a9100f4f4efe4b8">vp</a>, <a class="code hl_variable" href="../../d9/d59/namespacegetIntegrand.html#a9e34c20b9b4b3f9db34da5515e091c7a">i_in</a>, <a class="code hl_variable" href="../../d9/d59/namespacegetIntegrand.html#affe557b99ce21081450f9a33337f29ab">channel</a>);</div>
<div class="line"><span class="lineno">  150</span> </div>
<div class="line"><span class="lineno">  151</span>    <span class="comment">// compute values of left/right vertex</span></div>
<div class="line"><span class="lineno">  152</span>    Q <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1L</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1R</a>;</div>
<div class="line"><span class="lineno">  153</span>    Q <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1L_hat</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1R_hat</a>;</div>
<div class="line"><span class="lineno">  154</span>    <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">not</a> <a class="code hl_define" href="../../d1/df8/master__parameters_8hpp.html#a8e29bcd96e548a3249a0a93917debc8b">SBE_DECOMPOSITION</a>) {</div>
<div class="line"><span class="lineno">  155</span>        <span class="keywordflow">switch</span> (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">k</a>) {</div>
<div class="line"><span class="lineno">  156</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6a8eff64c74e8a1744163cada25ca8087e">k1</a>:</div>
<div class="line"><span class="lineno">  157</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a> = vertex1.template <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">left_same_bare&lt;channel&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_l</a>);</div>
<div class="line"><span class="lineno">  158</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a> = vertex2.template <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">right_same_bare&lt;channel&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_r</a>);</div>
<div class="line"><span class="lineno">  159</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_l</a>.spin = 1 - <a class="code hl_enumvalue" href="../../db/d58/namespacemy__defs_1_1K1.html#ae0dde289d1bfdb687324024b44a56cb3a0e8f8c5700d73a66191a72ea5eba2082">spin</a>;</div>
<div class="line"><span class="lineno">  160</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_r</a>.spin = 1 - <a class="code hl_enumvalue" href="../../db/d58/namespacemy__defs_1_1K1.html#ae0dde289d1bfdb687324024b44a56cb3a0e8f8c5700d73a66191a72ea5eba2082">spin</a>;</div>
<div class="line"><span class="lineno">  161</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_Vhat</a> = vertex1.template <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">left_same_bare&lt;channel&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_l</a>);</div>
<div class="line"><span class="lineno">  162</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_Vhat</a> = vertex2.template <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">right_same_bare&lt;channel&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_r</a>);</div>
<div class="line"><span class="lineno">  163</span> </div>
<div class="line"><span class="lineno">  164</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  165</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6aacf29f614329fe5521d57037364d33eb">k2</a>:</div>
<div class="line"><span class="lineno">  166</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a> = vertex1.template <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">left_diff_bare&lt;channel&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_l</a>);</div>
<div class="line"><span class="lineno">  167</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a> = vertex2.template <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">right_same_bare&lt;channel&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_r</a>);</div>
<div class="line"><span class="lineno">  168</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_l</a>.spin = 1 - <a class="code hl_enumvalue" href="../../db/d58/namespacemy__defs_1_1K1.html#ae0dde289d1bfdb687324024b44a56cb3a0e8f8c5700d73a66191a72ea5eba2082">spin</a>;</div>
<div class="line"><span class="lineno">  169</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_r</a>.spin = 1 - <a class="code hl_enumvalue" href="../../db/d58/namespacemy__defs_1_1K1.html#ae0dde289d1bfdb687324024b44a56cb3a0e8f8c5700d73a66191a72ea5eba2082">spin</a>;</div>
<div class="line"><span class="lineno">  170</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_Vhat</a> = vertex1.template <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">left_diff_bare&lt;channel&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_l</a>);</div>
<div class="line"><span class="lineno">  171</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_Vhat</a> = vertex2.template <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">right_same_bare&lt;channel&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_r</a>);</div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  174</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6aa19218abb77b991092b345b894ec3021">k2b</a>:</div>
<div class="line"><span class="lineno">  175</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a> = vertex1.template <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">left_same_bare&lt;channel&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_l</a>);</div>
<div class="line"><span class="lineno">  176</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a> = vertex2.template <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">right_diff_bare&lt;channel&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_r</a>);</div>
<div class="line"><span class="lineno">  177</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_l</a>.spin = 1 - <a class="code hl_enumvalue" href="../../db/d58/namespacemy__defs_1_1K1.html#ae0dde289d1bfdb687324024b44a56cb3a0e8f8c5700d73a66191a72ea5eba2082">spin</a>;</div>
<div class="line"><span class="lineno">  178</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_r</a>.spin = 1 - <a class="code hl_enumvalue" href="../../db/d58/namespacemy__defs_1_1K1.html#ae0dde289d1bfdb687324024b44a56cb3a0e8f8c5700d73a66191a72ea5eba2082">spin</a>;</div>
<div class="line"><span class="lineno">  179</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_Vhat</a> = vertex1.template <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">left_same_bare&lt;channel&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_l</a>);</div>
<div class="line"><span class="lineno">  180</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_Vhat</a> = vertex2.template <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">right_diff_bare&lt;channel&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_r</a>);</div>
<div class="line"><span class="lineno">  181</span> </div>
<div class="line"><span class="lineno">  182</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  183</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6a583b10bbc3d9ca5483f447cc6daa0a90">k3</a>:</div>
<div class="line"><span class="lineno">  184</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a> = vertex1.template <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">left_diff_bare&lt;channel&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_l</a>);</div>
<div class="line"><span class="lineno">  185</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a> = vertex2.template <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">right_diff_bare&lt;channel&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_r</a>);</div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_l</a>.spin = 1 - <a class="code hl_enumvalue" href="../../db/d58/namespacemy__defs_1_1K1.html#ae0dde289d1bfdb687324024b44a56cb3a0e8f8c5700d73a66191a72ea5eba2082">spin</a>;</div>
<div class="line"><span class="lineno">  188</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_r</a>.spin = 1 - <a class="code hl_enumvalue" href="../../db/d58/namespacemy__defs_1_1K1.html#ae0dde289d1bfdb687324024b44a56cb3a0e8f8c5700d73a66191a72ea5eba2082">spin</a>;</div>
<div class="line"><span class="lineno">  189</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_Vhat</a> = vertex1.template <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">left_diff_bare&lt;channel&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_l</a>);</div>
<div class="line"><span class="lineno">  190</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_Vhat</a> = vertex2.template <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">right_diff_bare&lt;channel&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_r</a>);</div>
<div class="line"><span class="lineno">  191</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  192</span>            <span class="keywordflow">default</span>:;</div>
<div class="line"><span class="lineno">  193</span>        }</div>
<div class="line"><span class="lineno">  194</span>    }</div>
<div class="line"><span class="lineno">  195</span>    <span class="keywordflow">else</span> { <span class="comment">// SBE_DECOMPOSITION</span></div>
<div class="line"><span class="lineno">  196</span>        <span class="comment">//assert(false); // TODO: Fix problems with analytic tails for SBE ? (alternatively just use quadrature)</span></div>
<div class="line"><span class="lineno">  197</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">assert</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">not</a> <a class="code hl_variable" href="../../d1/df8/master__parameters_8hpp.html#afab5195e3ffff420d211040e5672fcbe">KELDYSH</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">and</a> <a class="code hl_define" href="../../d1/df8/master__parameters_8hpp.html#a2428b0f27a9cc2786d9454e71820f2e9">SWITCH_SUM_N_INTEGRAL</a>);</div>
<div class="line"><span class="lineno">  198</span>        <span class="keywordflow">switch</span> (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">k</a>) {</div>
<div class="line"><span class="lineno">  199</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6a8eff64c74e8a1744163cada25ca8087e">k1</a>: {</div>
<div class="line"><span class="lineno">  200</span>                <a class="code hl_struct" href="../../d2/db2/structVertexInput.html">VertexInput</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_for_expanded_vertex</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_l</a>;</div>
<div class="line"><span class="lineno">  201</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_for_expanded_vertex</a>.<a class="code hl_variable" href="../../d2/db2/structVertexInput.html#a1d771b43454581ec99290380e35a477d">spin</a> = 0;</div>
<div class="line"><span class="lineno">  202</span> </div>
<div class="line"><span class="lineno">  203</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1L</a>    = vertex1.template <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">get_w_r_value_symmetry_expanded_nondiff&lt;spin, channel, channel, k1, Q&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_for_expanded_vertex</a>);</div>
<div class="line"><span class="lineno">  204</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1R</a>    = vertex2.template <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">get_w_r_value_symmetry_expanded_nondiff&lt;spin, channel, channel, k1, Q&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_for_expanded_vertex</a>);</div>
<div class="line"><span class="lineno">  205</span> </div>
<div class="line"><span class="lineno">  206</span> </div>
<div class="line"><span class="lineno">  207</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a> = vertex1.template <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">left_same_bare_symmetry_expanded&lt;spin,channel,Q&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_l</a>);</div>
<div class="line"><span class="lineno">  208</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a> = vertex2.template <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">right_same_bare_symmetry_expanded&lt;spin,channel,Q&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_r</a>);</div>
<div class="line"><span class="lineno">  209</span> </div>
<div class="line"><span class="lineno">  210</span> </div>
<div class="line"><span class="lineno">  211</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1L_hat</a> = vertex1.template get_w_r_value_symmetry_expanded_nondiff&lt;1 - <a class="code hl_enumvalue" href="../../db/d58/namespacemy__defs_1_1K1.html#ae0dde289d1bfdb687324024b44a56cb3a0e8f8c5700d73a66191a72ea5eba2082">spin</a>, <a class="code hl_variable" href="../../d9/d59/namespacegetIntegrand.html#affe557b99ce21081450f9a33337f29ab">channel</a>, <a class="code hl_variable" href="../../d9/d59/namespacegetIntegrand.html#affe557b99ce21081450f9a33337f29ab">channel</a>, <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6a8eff64c74e8a1744163cada25ca8087e">k1</a>, Q&gt;(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_for_expanded_vertex</a>);</div>
<div class="line"><span class="lineno">  212</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1R_hat</a> = vertex2.template get_w_r_value_symmetry_expanded_nondiff&lt;1 - <a class="code hl_enumvalue" href="../../db/d58/namespacemy__defs_1_1K1.html#ae0dde289d1bfdb687324024b44a56cb3a0e8f8c5700d73a66191a72ea5eba2082">spin</a>, <a class="code hl_variable" href="../../d9/d59/namespacegetIntegrand.html#affe557b99ce21081450f9a33337f29ab">channel</a>, <a class="code hl_variable" href="../../d9/d59/namespacegetIntegrand.html#affe557b99ce21081450f9a33337f29ab">channel</a>, <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6a8eff64c74e8a1744163cada25ca8087e">k1</a>, Q&gt;(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_for_expanded_vertex</a>);</div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_Vhat</a> = vertex1.template left_same_bare_symmetry_expanded&lt;1 - <a class="code hl_enumvalue" href="../../db/d58/namespacemy__defs_1_1K1.html#ae0dde289d1bfdb687324024b44a56cb3a0e8f8c5700d73a66191a72ea5eba2082">spin</a>, <a class="code hl_variable" href="../../d9/d59/namespacegetIntegrand.html#affe557b99ce21081450f9a33337f29ab">channel</a>, Q&gt;(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_l</a>);</div>
<div class="line"><span class="lineno">  215</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_Vhat</a> = vertex2.template right_same_bare_symmetry_expanded&lt;1 - <a class="code hl_enumvalue" href="../../db/d58/namespacemy__defs_1_1K1.html#ae0dde289d1bfdb687324024b44a56cb3a0e8f8c5700d73a66191a72ea5eba2082">spin</a>, <a class="code hl_variable" href="../../d9/d59/namespacegetIntegrand.html#affe557b99ce21081450f9a33337f29ab">channel</a>, Q&gt;(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_r</a>);</div>
<div class="line"><span class="lineno">  216</span>            }</div>
<div class="line"><span class="lineno">  217</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  218</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6aacf29f614329fe5521d57037364d33eb">k2</a>:</div>
<div class="line"><span class="lineno">  219</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a> = vertex1.template <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">left_diff_bare_symmetry_expanded&lt;spin, channel, Q&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_l</a>);</div>
<div class="line"><span class="lineno">  220</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a> = vertex2.template <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">right_same_bare_symmetry_expanded&lt;spin, channel, Q&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_r</a>);</div>
<div class="line"><span class="lineno">  221</span> </div>
<div class="line"><span class="lineno">  222</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_Vhat</a> = vertex1.template left_diff_bare_symmetry_expanded&lt;1 - <a class="code hl_enumvalue" href="../../db/d58/namespacemy__defs_1_1K1.html#ae0dde289d1bfdb687324024b44a56cb3a0e8f8c5700d73a66191a72ea5eba2082">spin</a>, <a class="code hl_variable" href="../../d9/d59/namespacegetIntegrand.html#affe557b99ce21081450f9a33337f29ab">channel</a>, Q&gt;(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_l</a>);</div>
<div class="line"><span class="lineno">  223</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_Vhat</a> = vertex2.template right_same_bare_symmetry_expanded&lt;1 - <a class="code hl_enumvalue" href="../../db/d58/namespacemy__defs_1_1K1.html#ae0dde289d1bfdb687324024b44a56cb3a0e8f8c5700d73a66191a72ea5eba2082">spin</a>, <a class="code hl_variable" href="../../d9/d59/namespacegetIntegrand.html#affe557b99ce21081450f9a33337f29ab">channel</a>, Q&gt;(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_r</a>);</div>
<div class="line"><span class="lineno">  224</span> </div>
<div class="line"><span class="lineno">  225</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  226</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6aa19218abb77b991092b345b894ec3021">k2b</a>:</div>
<div class="line"><span class="lineno">  227</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a> = vertex1.template <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">left_same_bare_symmetry_expanded&lt;spin, channel, Q&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_l</a>);</div>
<div class="line"><span class="lineno">  228</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a> = vertex2.template <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">right_diff_bare_symmetry_expanded&lt;spin, channel, Q&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_r</a>);</div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_Vhat</a> = vertex1.template left_same_bare_symmetry_expanded&lt;1 - <a class="code hl_enumvalue" href="../../db/d58/namespacemy__defs_1_1K1.html#ae0dde289d1bfdb687324024b44a56cb3a0e8f8c5700d73a66191a72ea5eba2082">spin</a>, <a class="code hl_variable" href="../../d9/d59/namespacegetIntegrand.html#affe557b99ce21081450f9a33337f29ab">channel</a>, Q&gt;(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_l</a>);</div>
<div class="line"><span class="lineno">  231</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_Vhat</a> = vertex2.template right_diff_bare_symmetry_expanded&lt;1 - <a class="code hl_enumvalue" href="../../db/d58/namespacemy__defs_1_1K1.html#ae0dde289d1bfdb687324024b44a56cb3a0e8f8c5700d73a66191a72ea5eba2082">spin</a>, <a class="code hl_variable" href="../../d9/d59/namespacegetIntegrand.html#affe557b99ce21081450f9a33337f29ab">channel</a>, Q&gt;(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_r</a>);</div>
<div class="line"><span class="lineno">  232</span> </div>
<div class="line"><span class="lineno">  233</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  234</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6a583b10bbc3d9ca5483f447cc6daa0a90">k3</a>:</div>
<div class="line"><span class="lineno">  235</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a> = vertex1.template <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">left_diff_bare_symmetry_expanded&lt;spin, channel, Q&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_l</a>);</div>
<div class="line"><span class="lineno">  236</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a> = vertex2.template <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">right_diff_bare_symmetry_expanded&lt;spin, channel, Q&gt;</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_r</a>);</div>
<div class="line"><span class="lineno">  237</span> </div>
<div class="line"><span class="lineno">  238</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_Vhat</a> = vertex1.template left_diff_bare_symmetry_expanded&lt;1 - <a class="code hl_enumvalue" href="../../db/d58/namespacemy__defs_1_1K1.html#ae0dde289d1bfdb687324024b44a56cb3a0e8f8c5700d73a66191a72ea5eba2082">spin</a>, <a class="code hl_variable" href="../../d9/d59/namespacegetIntegrand.html#affe557b99ce21081450f9a33337f29ab">channel</a>, Q&gt;(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_l</a>);</div>
<div class="line"><span class="lineno">  239</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_Vhat</a> = vertex2.template right_diff_bare_symmetry_expanded&lt;1 - <a class="code hl_enumvalue" href="../../db/d58/namespacemy__defs_1_1K1.html#ae0dde289d1bfdb687324024b44a56cb3a0e8f8c5700d73a66191a72ea5eba2082">spin</a>, <a class="code hl_variable" href="../../d9/d59/namespacegetIntegrand.html#affe557b99ce21081450f9a33337f29ab">channel</a>, Q&gt;(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input_r</a>);</div>
<div class="line"><span class="lineno">  240</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  241</span>            <span class="keywordflow">default</span>:;</div>
<div class="line"><span class="lineno">  242</span>        }</div>
<div class="line"><span class="lineno">  243</span> </div>
<div class="line"><span class="lineno">  244</span>    }</div>
<div class="line"><span class="lineno">  245</span> </div>
<div class="line"><span class="lineno">  246</span>    <span class="comment">// compute the value of the (analytically integrated) bubble</span></div>
<div class="line"><span class="lineno">  247</span>    Q <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Pival</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#a01260bb95278d85a754cbc39bafb7bb2">correctionFunctionBubble</a>(w * ((<a class="code hl_define" href="../../d1/df8/master__parameters_8hpp.html#a722c2af0617ed167ad80956c733f131c">KELDYSH_FORMALISM</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">or</a> <a class="code hl_variable" href="../../d1/df8/master__parameters_8hpp.html#acc079412030119547ab769b82d3c37d1">ZERO_T</a>) ? 1. : <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">M_PI</a>*G.T), vmin * ((<a class="code hl_define" href="../../d1/df8/master__parameters_8hpp.html#a722c2af0617ed167ad80956c733f131c">KELDYSH_FORMALISM</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">or</a> <a class="code hl_variable" href="../../d1/df8/master__parameters_8hpp.html#acc079412030119547ab769b82d3c37d1">ZERO_T</a>) ? 1. : <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">M_PI</a>*G.T), vmax * ((<a class="code hl_define" href="../../d1/df8/master__parameters_8hpp.html#a722c2af0617ed167ad80956c733f131c">KELDYSH_FORMALISM</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">or</a> <a class="code hl_variable" href="../../d1/df8/master__parameters_8hpp.html#acc079412030119547ab769b82d3c37d1">ZERO_T</a>) ? 1. : <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">M_PI</a>*G.T), G.epsilon, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_H</a>, Delta, G.Lambda, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">eta_1</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">eta_2</a>, <a class="code hl_variable" href="../../d9/d59/namespacegetIntegrand.html#affe557b99ce21081450f9a33337f29ab">channel</a>, diff);</div>
<div class="line"><span class="lineno">  248</span> </div>
<div class="line"><span class="lineno">  249</span> </div>
<div class="line"><span class="lineno">  250</span>    <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (<a class="code hl_define" href="../../d1/df8/master__parameters_8hpp.html#a8e29bcd96e548a3249a0a93917debc8b">SBE_DECOMPOSITION</a>) {</div>
<div class="line"><span class="lineno">  251</span>        <span class="keywordflow">if</span> ((channel == <span class="charliteral">&#39;t&#39;</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">and</a> spin == 0) <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">or</a> (channel == <span class="charliteral">&#39;a&#39;</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">and</a> spin == 1)) {</div>
<div class="line"><span class="lineno">  252</span> </div>
<div class="line"><span class="lineno">  253</span>            <span class="keywordflow">switch</span> (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">k</a>) {</div>
<div class="line"><span class="lineno">  254</span>                <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6a8eff64c74e8a1744163cada25ca8087e">k1</a>:</div>
<div class="line"><span class="lineno">  255</span>                    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res</a> =   (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1L</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1L_hat</a>) * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_Vhat</a>) * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Pival</a> * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_Vhat</a>) * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1R</a>)</div>
<div class="line"><span class="lineno">  256</span>                          + (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1L</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1L_hat</a>) * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_Vhat</a>) * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Pival</a> * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a>) * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1R</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1R_hat</a>)</div>
<div class="line"><span class="lineno">  257</span>                          + (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1L</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1L_hat</a>) * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a>) * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Pival</a> * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_Vhat</a>) * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1R</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1R_hat</a>)</div>
<div class="line"><span class="lineno">  258</span>                          + (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1L</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1L_hat</a>) * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a>) * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Pival</a> * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a>) * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1R</a>)</div>
<div class="line"><span class="lineno">  259</span>                          + (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1L</a>) * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a>) * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Pival</a> * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_Vhat</a>) * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1R</a>)</div>
<div class="line"><span class="lineno">  260</span>                          + (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1L</a>) * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a>) * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Pival</a> * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a>) * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1R</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1R_hat</a>)</div>
<div class="line"><span class="lineno">  261</span>                          + (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1L</a>) * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_Vhat</a>) * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Pival</a> * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_Vhat</a>) * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1R</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1R_hat</a>)</div>
<div class="line"><span class="lineno">  262</span>                          + (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1L</a>) * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_Vhat</a>) * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Pival</a> * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a>) * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1R</a>);</div>
<div class="line"><span class="lineno">  263</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  264</span>                <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6aacf29f614329fe5521d57037364d33eb">k2</a>:</div>
<div class="line"><span class="lineno">  265</span>                    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res</a> = (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_Vhat</a>) * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Pival</a> * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a> * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Pival</a> * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_Vhat</a>);</div>
<div class="line"><span class="lineno">  266</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  267</span>                <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6aa19218abb77b991092b345b894ec3021">k2b</a>:</div>
<div class="line"><span class="lineno">  268</span>                    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res</a> = (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_Vhat</a>) * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Pival</a> * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a> * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Pival</a> * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_Vhat</a>);</div>
<div class="line"><span class="lineno">  269</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  270</span>                <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6a583b10bbc3d9ca5483f447cc6daa0a90">k3</a>:</div>
<div class="line"><span class="lineno">  271</span>                    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res</a> = (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_Vhat</a>) * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Pival</a> * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a> * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Pival</a> * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_Vhat</a>);</div>
<div class="line"><span class="lineno">  272</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  273</span>                <span class="keywordflow">default</span>:;</div>
<div class="line"><span class="lineno">  274</span>            }</div>
<div class="line"><span class="lineno">  275</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (channel == <span class="charliteral">&#39;p&#39;</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">and</a> spin == 1) {</div>
<div class="line"><span class="lineno">  276</span> </div>
<div class="line"><span class="lineno">  277</span>            <span class="keywordflow">switch</span> (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">k</a>) {</div>
<div class="line"><span class="lineno">  278</span>                <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6a8eff64c74e8a1744163cada25ca8087e">k1</a>:</div>
<div class="line"><span class="lineno">  279</span>                    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1L</a> * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_Vhat</a>) * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Pival</a> * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_Vhat</a>) * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1R_hat</a>;</div>
<div class="line"><span class="lineno">  280</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  281</span>                <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6aacf29f614329fe5521d57037364d33eb">k2</a>:</div>
<div class="line"><span class="lineno">  282</span>                    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_Vhat</a> * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Pival</a> * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a>);</div>
<div class="line"><span class="lineno">  283</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  284</span>                <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6aa19218abb77b991092b345b894ec3021">k2b</a>:</div>
<div class="line"><span class="lineno">  285</span>                    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res</a> = (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a>) * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Pival</a> * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_Vhat</a>;</div>
<div class="line"><span class="lineno">  286</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  287</span>                <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6a583b10bbc3d9ca5483f447cc6daa0a90">k3</a>:</div>
<div class="line"><span class="lineno">  288</span>                    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a> * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Pival</a> * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_Vhat</a>;</div>
<div class="line"><span class="lineno">  289</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  290</span>                <span class="keywordflow">default</span>:;</div>
<div class="line"><span class="lineno">  291</span>            }</div>
<div class="line"><span class="lineno">  292</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  293</span> </div>
<div class="line"><span class="lineno">  294</span>            <span class="keywordflow">switch</span> (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">k</a>) {</div>
<div class="line"><span class="lineno">  295</span>                <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6a8eff64c74e8a1744163cada25ca8087e">k1</a>:</div>
<div class="line"><span class="lineno">  296</span>                    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1L</a> * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a>) * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Pival</a> * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a>) * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">K1R</a>;</div>
<div class="line"><span class="lineno">  297</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  298</span>                <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6aacf29f614329fe5521d57037364d33eb">k2</a>:</div>
<div class="line"><span class="lineno">  299</span>                    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a> * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Pival</a> * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a>);</div>
<div class="line"><span class="lineno">  300</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  301</span>                <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6aa19218abb77b991092b345b894ec3021">k2b</a>:</div>
<div class="line"><span class="lineno">  302</span>                    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res</a> = (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a>) * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Pival</a> * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a>;</div>
<div class="line"><span class="lineno">  303</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  304</span>                <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6a583b10bbc3d9ca5483f447cc6daa0a90">k3</a>:</div>
<div class="line"><span class="lineno">  305</span>                    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a> * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Pival</a> * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a>;</div>
<div class="line"><span class="lineno">  306</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  307</span>                <span class="keywordflow">default</span>:;</div>
<div class="line"><span class="lineno">  308</span>            }</div>
<div class="line"><span class="lineno">  309</span>        }</div>
<div class="line"><span class="lineno">  310</span>    }</div>
<div class="line"><span class="lineno">  311</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  312</span>        <span class="comment">// compute result, with spin sum depending on the channel</span></div>
<div class="line"><span class="lineno">  313</span>        <span class="keywordflow">switch</span> (channel) {</div>
<div class="line"><span class="lineno">  314</span>            <span class="keywordflow">case</span> <span class="charliteral">&#39;a&#39;</span>:</div>
<div class="line"><span class="lineno">  315</span>                <span class="keywordflow">if</span> (spin == 0) {</div>
<div class="line"><span class="lineno">  316</span>                    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a> * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Pival</a> * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a>;</div>
<div class="line"><span class="lineno">  317</span>                }</div>
<div class="line"><span class="lineno">  318</span><span class="preprocessor">#if DEBUG_SYMMETRIES</span></div>
<div class="line"><span class="lineno">  319</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (spin == 1) {</div>
<div class="line"><span class="lineno">  320</span>                    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a> * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Pival</a> * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_Vhat</a>) + (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_Vhat</a>) * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Pival</a> * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a>;</div>
<div class="line"><span class="lineno">  321</span>                }</div>
<div class="line"><span class="lineno">  322</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  323</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  324</span>            <span class="keywordflow">case</span> <span class="charliteral">&#39;p&#39;</span>:</div>
<div class="line"><span class="lineno">  325</span>                <span class="keywordflow">if</span> (spin == 0) {</div>
<div class="line"><span class="lineno">  326</span>                    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a> * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Pival</a> * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a>;</div>
<div class="line"><span class="lineno">  327</span>                }</div>
<div class="line"><span class="lineno">  328</span><span class="preprocessor">#if DEBUG_SYMMETRIES</span></div>
<div class="line"><span class="lineno">  329</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (spin == 1) {</div>
<div class="line"><span class="lineno">  330</span>                    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a> * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Pival</a> * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_Vhat</a>;</div>
<div class="line"><span class="lineno">  331</span>                }</div>
<div class="line"><span class="lineno">  332</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  333</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  334</span>            <span class="keywordflow">case</span> <span class="charliteral">&#39;t&#39;</span>:</div>
<div class="line"><span class="lineno">  335</span>                <span class="keywordflow">if</span> (spin == 0) {</div>
<div class="line"><span class="lineno">  336</span>                    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a> * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Pival</a> * (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_Vhat</a>) + (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_Vhat</a>) * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Pival</a> * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a>;</div>
<div class="line"><span class="lineno">  337</span>                }</div>
<div class="line"><span class="lineno">  338</span><span class="preprocessor">#if DEBUG_SYMMETRIES</span></div>
<div class="line"><span class="lineno">  339</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (spin == 1) {</div>
<div class="line"><span class="lineno">  340</span>                    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res</a> = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_l_V</a> * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Pival</a> * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res_r_V</a>;</div>
<div class="line"><span class="lineno">  341</span>                }</div>
<div class="line"><span class="lineno">  342</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  343</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  344</span>            <span class="keywordflow">default</span>:;</div>
<div class="line"><span class="lineno">  345</span>        }</div>
<div class="line"><span class="lineno">  346</span>    }</div>
<div class="line"><span class="lineno">  347</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">assert</a>(<a class="code hl_function" href="../../da/d4d/data__structures_8c_09_09.html#a1b776da091e98686fc5f400e4f91ea9d">my_isfinite</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res</a>));</div>
<div class="line"><span class="lineno">  348</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">res</a>;</div>
<div class="line"><span class="lineno">  349</span>}</div>
<div class="ttc" id="aKeldysh__symmetries_8c_09_09_html_a8ce5883bf24e8dbb17eb7e2cf3c51afe"><div class="ttname"><a href="../../d4/de0/Keldysh__symmetries_8c_09_09.html#a8ce5883bf24e8dbb17eb7e2cf3c51afe">indices_sum</a></div><div class="ttdeci">auto indices_sum(int i0, int i2, const char channel) -&gt; std::vector&lt; int &gt;</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de0/Keldysh__symmetries_8c_09_09_source.html#l00035">Keldysh_symmetries.c++:35</a></div></div>
<div class="ttc" id="abubble__corrections_8hpp_html_a01260bb95278d85a754cbc39bafb7bb2"><div class="ttname"><a href="../../dd/dea/bubble__corrections_8hpp.html#a01260bb95278d85a754cbc39bafb7bb2">correctionFunctionBubble</a></div><div class="ttdeci">auto correctionFunctionBubble(double w, double vmin, double vmax, double epsilon, Q Sigma_H, double Delta, double Lambda, double eta_1, double eta_2, char channel, bool diff) -&gt; Q</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dea/bubble__corrections_8hpp_source.html#l00459">bubble_corrections.hpp:459</a></div></div>
<div class="ttc" id="abubble__corrections_8hpp_html_aff27784f97591f505f77ff0065ab57af"><div class="ttname"><a href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">correctionFunctionBubble_REG3_Matsubara_PHS_diff</a></div><div class="ttdeci">auto correctionFunctionBubble_REG3_Matsubara_PHS_diff(double w, double vmax, double Lambda, const double Delta)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dea/bubble__corrections_8hpp_source.html#l00295">bubble_corrections.hpp:295</a></div></div>
<div class="ttc" id="aclassPropagator_html_a3c6ea2e6484393ae6b8dae0e93b52ada"><div class="ttname"><a href="../../d2/d34/classPropagator.html#a3c6ea2e6484393ae6b8dae0e93b52ada">Propagator::selfenergy</a></div><div class="ttdeci">const SelfEnergy&lt; Q &gt; &amp; selfenergy</div><div class="ttdef"><b>Definition</b> <a href="../../d5/df7/propagator_8hpp_source.html#l00035">propagator.hpp:35</a></div></div>
<div class="ttc" id="aclassPropagator_html_aa1d72170fcc752ac7164f4cbb31ef281"><div class="ttname"><a href="../../d2/d34/classPropagator.html#aa1d72170fcc752ac7164f4cbb31ef281">Propagator::Gamma</a></div><div class="ttdeci">const double Gamma</div><div class="ttdef"><b>Definition</b> <a href="../../d5/df7/propagator_8hpp_source.html#l00039">propagator.hpp:39</a></div></div>
<div class="ttc" id="aclassPropagator_html_ad14d8669e7e3b6934df9ba2fa6168a75"><div class="ttname"><a href="../../d2/d34/classPropagator.html#ad14d8669e7e3b6934df9ba2fa6168a75">Propagator::Lambda</a></div><div class="ttdeci">const double Lambda</div><div class="ttdef"><b>Definition</b> <a href="../../d5/df7/propagator_8hpp_source.html#l00034">propagator.hpp:34</a></div></div>
<div class="ttc" id="adata__structures_8c_09_09_html_a1b776da091e98686fc5f400e4f91ea9d"><div class="ttname"><a href="../../da/d4d/data__structures_8c_09_09.html#a1b776da091e98686fc5f400e4f91ea9d">my_isfinite</a></div><div class="ttdeci">auto my_isfinite(comp z) -&gt; bool</div><div class="ttdef"><b>Definition</b> <a href="../../da/d4d/data__structures_8c_09_09_source.html#l00003">data_structures.c++:3</a></div></div>
<div class="ttc" id="adata__structures_8hpp_html_a82cbf94ae42de55eaaa115fc78dffbc6a583b10bbc3d9ca5483f447cc6daa0a90"><div class="ttname"><a href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6a583b10bbc3d9ca5483f447cc6daa0a90">k3</a></div><div class="ttdeci">@ k3</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d59/data__structures_8hpp_source.html#l00480">data_structures.hpp:480</a></div></div>
<div class="ttc" id="adata__structures_8hpp_html_a82cbf94ae42de55eaaa115fc78dffbc6a8eff64c74e8a1744163cada25ca8087e"><div class="ttname"><a href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6a8eff64c74e8a1744163cada25ca8087e">k1</a></div><div class="ttdeci">@ k1</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d59/data__structures_8hpp_source.html#l00480">data_structures.hpp:480</a></div></div>
<div class="ttc" id="adata__structures_8hpp_html_a82cbf94ae42de55eaaa115fc78dffbc6aa19218abb77b991092b345b894ec3021"><div class="ttname"><a href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6aa19218abb77b991092b345b894ec3021">k2b</a></div><div class="ttdeci">@ k2b</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d59/data__structures_8hpp_source.html#l00480">data_structures.hpp:480</a></div></div>
<div class="ttc" id="adata__structures_8hpp_html_a82cbf94ae42de55eaaa115fc78dffbc6aacf29f614329fe5521d57037364d33eb"><div class="ttname"><a href="../../d7/d59/data__structures_8hpp.html#a82cbf94ae42de55eaaa115fc78dffbc6aacf29f614329fe5521d57037364d33eb">k2</a></div><div class="ttdeci">@ k2</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d59/data__structures_8hpp_source.html#l00480">data_structures.hpp:480</a></div></div>
<div class="ttc" id="amaster__parameters_8hpp_html_a2428b0f27a9cc2786d9454e71820f2e9"><div class="ttname"><a href="../../d1/df8/master__parameters_8hpp.html#a2428b0f27a9cc2786d9454e71820f2e9">SWITCH_SUM_N_INTEGRAL</a></div><div class="ttdeci">#define SWITCH_SUM_N_INTEGRAL</div><div class="ttdoc">0 for false; 1 for true. If true, the sum over internal Keldysh indices is done before the frequency ...</div><div class="ttdef"><b>Definition</b> <a href="../../d1/df8/master__parameters_8hpp_source.html#l00021">master_parameters.hpp:21</a></div></div>
<div class="ttc" id="amaster__parameters_8hpp_html_a722c2af0617ed167ad80956c733f131c"><div class="ttname"><a href="../../d1/df8/master__parameters_8hpp.html#a722c2af0617ed167ad80956c733f131c">KELDYSH_FORMALISM</a></div><div class="ttdeci">#define KELDYSH_FORMALISM</div><div class="ttdoc">Determines whether calculations shall be done in the Keldysh or Matsubara formalism....</div><div class="ttdef"><b>Definition</b> <a href="../../d1/df8/master__parameters_8hpp_source.html#l00019">master_parameters.hpp:19</a></div></div>
<div class="ttc" id="amaster__parameters_8hpp_html_a8e29bcd96e548a3249a0a93917debc8b"><div class="ttname"><a href="../../d1/df8/master__parameters_8hpp.html#a8e29bcd96e548a3249a0a93917debc8b">SBE_DECOMPOSITION</a></div><div class="ttdeci">#define SBE_DECOMPOSITION</div><div class="ttdef"><b>Definition</b> <a href="../../d1/df8/master__parameters_8hpp_source.html#l00035">master_parameters.hpp:35</a></div></div>
<div class="ttc" id="amaster__parameters_8hpp_html_ac12997fa537ec8cbf0f69bf8228cc2a0"><div class="ttname"><a href="../../d1/df8/master__parameters_8hpp.html#ac12997fa537ec8cbf0f69bf8228cc2a0">REG</a></div><div class="ttdeci">#define REG</div><div class="ttdoc">fRG parameters ///</div><div class="ttdef"><b>Definition</b> <a href="../../d1/df8/master__parameters_8hpp_source.html#l00087">master_parameters.hpp:87</a></div></div>
<div class="ttc" id="amaster__parameters_8hpp_html_acc079412030119547ab769b82d3c37d1"><div class="ttname"><a href="../../d1/df8/master__parameters_8hpp.html#acc079412030119547ab769b82d3c37d1">ZERO_T</a></div><div class="ttdeci">constexpr bool ZERO_T</div><div class="ttdef"><b>Definition</b> <a href="../../d1/df8/master__parameters_8hpp_source.html#l00144">master_parameters.hpp:144</a></div></div>
<div class="ttc" id="amaster__parameters_8hpp_html_afab5195e3ffff420d211040e5672fcbe"><div class="ttname"><a href="../../d1/df8/master__parameters_8hpp.html#afab5195e3ffff420d211040e5672fcbe">KELDYSH</a></div><div class="ttdeci">constexpr bool KELDYSH</div><div class="ttdoc">Set flags used in code; DO NOT TOUCH!!!///.</div><div class="ttdef"><b>Definition</b> <a href="../../d1/df8/master__parameters_8hpp_source.html#l00137">master_parameters.hpp:137</a></div></div>
<div class="ttc" id="anamespacegetIntegrand_html_a4e095fa5805b564f2a9100f4f4efe4b8"><div class="ttname"><a href="../../d9/d59/namespacegetIntegrand.html#a4e095fa5805b564f2a9100f4f4efe4b8">getIntegrand.vp</a></div><div class="ttdeci">int vp</div><div class="ttdef"><b>Definition</b> <a href="../../de/d62/getIntegrand_8py_source.html#l00273">getIntegrand.py:273</a></div></div>
<div class="ttc" id="anamespacegetIntegrand_html_a8c9600ab594068787054475dc580f6c0"><div class="ttname"><a href="../../d9/d59/namespacegetIntegrand.html#a8c9600ab594068787054475dc580f6c0">getIntegrand.i0</a></div><div class="ttdeci">int i0</div><div class="ttdef"><b>Definition</b> <a href="../../de/d62/getIntegrand_8py_source.html#l00268">getIntegrand.py:268</a></div></div>
<div class="ttc" id="anamespacegetIntegrand_html_a8de2c1f4f0e95b0891bbf53c7585193c"><div class="ttname"><a href="../../d9/d59/namespacegetIntegrand.html#a8de2c1f4f0e95b0891bbf53c7585193c">getIntegrand.v</a></div><div class="ttdeci">int v</div><div class="ttdef"><b>Definition</b> <a href="../../de/d62/getIntegrand_8py_source.html#l00272">getIntegrand.py:272</a></div></div>
<div class="ttc" id="anamespacegetIntegrand_html_a9e34c20b9b4b3f9db34da5515e091c7a"><div class="ttname"><a href="../../d9/d59/namespacegetIntegrand.html#a9e34c20b9b4b3f9db34da5515e091c7a">getIntegrand.i_in</a></div><div class="ttdeci">int i_in</div><div class="ttdef"><b>Definition</b> <a href="../../de/d62/getIntegrand_8py_source.html#l00274">getIntegrand.py:274</a></div></div>
<div class="ttc" id="anamespacegetIntegrand_html_ac27f31b5826d872c73024a5fa645598f"><div class="ttname"><a href="../../d9/d59/namespacegetIntegrand.html#ac27f31b5826d872c73024a5fa645598f">getIntegrand.w</a></div><div class="ttdeci">int w</div><div class="ttdef"><b>Definition</b> <a href="../../de/d62/getIntegrand_8py_source.html#l00271">getIntegrand.py:271</a></div></div>
<div class="ttc" id="anamespacegetIntegrand_html_affe557b99ce21081450f9a33337f29ab"><div class="ttname"><a href="../../d9/d59/namespacegetIntegrand.html#affe557b99ce21081450f9a33337f29ab">getIntegrand.channel</a></div><div class="ttdeci">str channel</div><div class="ttdef"><b>Definition</b> <a href="../../de/d62/getIntegrand_8py_source.html#l00267">getIntegrand.py:267</a></div></div>
<div class="ttc" id="anamespacemy__defs_1_1K1_html_ae0dde289d1bfdb687324024b44a56cb3a0e8f8c5700d73a66191a72ea5eba2082"><div class="ttname"><a href="../../db/d58/namespacemy__defs_1_1K1.html#ae0dde289d1bfdb687324024b44a56cb3a0e8f8c5700d73a66191a72ea5eba2082">my_defs::K1::spin</a></div><div class="ttdeci">@ spin</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d59/data__structures_8hpp_source.html#l00499">data_structures.hpp:499</a></div></div>
<div class="ttc" id="astructVertexInput_html"><div class="ttname"><a href="../../d2/db2/structVertexInput.html">VertexInput</a></div><div class="ttdef"><b>Definition</b> <a href="../../d7/d59/data__structures_8hpp_source.html#l00536">data_structures.hpp:536</a></div></div>
<div class="ttc" id="astructVertexInput_html_a1d771b43454581ec99290380e35a477d"><div class="ttname"><a href="../../d2/db2/structVertexInput.html#a1d771b43454581ec99290380e35a477d">VertexInput::spin</a></div><div class="ttdeci">my_index_t spin</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d59/data__structures_8hpp_source.html#l00540">data_structures.hpp:540</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/dea/bubble__corrections_8hpp_source.html#l00459">correctionFunctionBubble()</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp_source.html#l00295">correctionFunctionBubble_REG3_Matsubara_PHS_diff()</a>, <a class="el" href="../../d4/de0/Keldysh__symmetries_8c_09_09_source.html#l00035">indices_sum()</a>, <a class="el" href="../../d7/d59/data__structures_8hpp_source.html#l00480">k1</a>, <a class="el" href="../../d7/d59/data__structures_8hpp_source.html#l00480">k2</a>, <a class="el" href="../../d7/d59/data__structures_8hpp_source.html#l00480">k2b</a>, <a class="el" href="../../d7/d59/data__structures_8hpp_source.html#l00480">k3</a>, <a class="el" href="../../d1/df8/master__parameters_8hpp_source.html#l00137">KELDYSH</a>, <a class="el" href="../../d1/df8/master__parameters_8hpp_source.html#l00019">KELDYSH_FORMALISM</a>, <a class="el" href="../../da/d4d/data__structures_8c_09_09_source.html#l00003">my_isfinite()</a>, <a class="el" href="../../d1/df8/master__parameters_8hpp_source.html#l00087">REG</a>, <a class="el" href="../../d1/df8/master__parameters_8hpp_source.html#l00035">SBE_DECOMPOSITION</a>, <a class="el" href="../../d7/d59/data__structures_8hpp_source.html#l00540">VertexInput::spin</a>, <a class="el" href="../../d1/df8/master__parameters_8hpp_source.html#l00021">SWITCH_SUM_N_INTEGRAL</a>, and <a class="el" href="../../d1/df8/master__parameters_8hpp_source.html#l00144">ZERO_T</a>.</p>

</div>
</div>
<a id="aa927c9725b69dc5c5cb4626e7c10ad17" name="aa927c9725b69dc5c5cb4626e7c10ad17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa927c9725b69dc5c5cb4626e7c10ad17">&#9670;&#160;</a></span>asymp_corrections_bubble_via_quadrature()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q , <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> <a class="el" href="../../d1/d9f/classIntegrand.html">Integrand</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">auto</a> asymp_corrections_bubble_via_quadrature </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d1/d9f/classIntegrand.html">Integrand</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>integrand</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> double</td>          <td class="paramname"><span class="paramname"><em>vmin</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> double</td>          <td class="paramname"><span class="paramname"><em>vmax</em></span>&#160;) -&gt; Q </td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes tails via quadrature routine. </p>
<p>Possible unit-tests: compare with quadrature routines for (semi-)infinite intervals </p>

<p class="definition">Definition at line <a class="el" href="../../d2/df0/correction__functions_8hpp_source.html#l00021">21</a> of file <a class="el" href="../../d2/df0/correction__functions_8hpp_source.html">correction_functions.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   21</span>                                                                                                                    {</div>
<div class="line"><span class="lineno">   22</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="../../dd/d1f/integrator_8hpp.html#a7d04a371ecbcd8fe19d860c0b46871d9">integrator_onlyTails</a>(integrand, vmin, vmax);</div>
<div class="line"><span class="lineno">   23</span>}</div>
<div class="ttc" id="aintegrator_8hpp_html_a7d04a371ecbcd8fe19d860c0b46871d9"><div class="ttname"><a href="../../dd/d1f/integrator_8hpp.html#a7d04a371ecbcd8fe19d860c0b46871d9">integrator_onlyTails</a></div><div class="ttdeci">auto integrator_onlyTails(Integrand &amp;integrand, const double vmin, const double vmax) -&gt; std::result_of_t&lt; Integrand(double)&gt;</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d1f/integrator_8hpp_source.html#l00408">integrator.hpp:408</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d1f/integrator_8hpp_source.html#l00408">integrator_onlyTails()</a>.</p>

</div>
</div>
<a id="ad39986be0f18f26c38ab2fe8016d5b0a" name="ad39986be0f18f26c38ab2fe8016d5b0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad39986be0f18f26c38ab2fe8016d5b0a">&#9670;&#160;</a></span>asymp_corrections_loop()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> Q , <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typename</a> <a class="el" href="../../d7/d59/data__structures_8hpp.html#a3931ffa7cd4a0005be369b34231a4b84">vertexType</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">auto</a> asymp_corrections_loop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d7/d59/data__structures_8hpp.html#a3931ffa7cd4a0005be369b34231a4b84">vertexType</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>vertex</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d2/d34/classPropagator.html">Propagator</a>&lt; Q &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>G</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>vmin</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>vmax</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>v</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>iK</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>ispin</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>i_in</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">const</a> <a class="el" href="../../d9/db9/classbool.html">bool</a></td>          <td class="paramname"><span class="paramname"><em>all_spins</em></span>&#160;) -&gt; Q </td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the analytical result for the asymptotic tails of the loop integral, assuming the self-energy of the propagator to be decayed to the Hartree value. The full result is (Gamma_0 + K1t(w = 0) + K2't(w = 0, v' = v)) * I_tails(vmin, vmax), where vmax/vmin are the upper/lower limits of the numerically evaluated integral, I_tails is the loop integral helper function defined above, containing the result of the analytical integration, and Gamma_0 is the bare vertex. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vertex</td><td>: Vertex in the loop </td></tr>
    <tr><td class="paramname">G</td><td>: Loop propagator </td></tr>
    <tr><td class="paramname">vmin</td><td>: Lower limit of the numerically evaluated integral in loop(...) </td></tr>
    <tr><td class="paramname">vmax</td><td>: Upper limit of the numerically evaluated integral in loop(...) </td></tr>
    <tr><td class="paramname">v</td><td>: External fermionic frequency </td></tr>
    <tr><td class="paramname">iK</td><td>: Keldysh index of the result (0: retarded component, 1: Keldysh component) </td></tr>
    <tr><td class="paramname">i_in</td><td>: Internal index </td></tr>
    <tr><td class="paramname">all_spins</td><td>: Determines if spin sum in loop is performed. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/df0/correction__functions_8hpp_source.html#l00371">371</a> of file <a class="el" href="../../d2/df0/correction__functions_8hpp_source.html">correction_functions.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  374</span>                                                                                              {</div>
<div class="line"><span class="lineno">  375</span> </div>
<div class="line"><span class="lineno">  376</span>    Q <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_H</a> = G.<a class="code hl_variable" href="../../d2/d34/classPropagator.html#a3c6ea2e6484393ae6b8dae0e93b52ada">selfenergy</a>.asymp_val_R;       <span class="comment">// Hartree self-energy</span></div>
<div class="line"><span class="lineno">  377</span>    <span class="keywordtype">double</span> Delta = (G.<a class="code hl_variable" href="../../d2/d34/classPropagator.html#aa1d72170fcc752ac7164f4cbb31ef281">Gamma</a> + G.<a class="code hl_variable" href="../../d2/d34/classPropagator.html#ad14d8669e7e3b6934df9ba2fa6168a75">Lambda</a>) / 2.; <span class="comment">// Hybridization (~ flow parameter) at which the bubble is evaluated</span></div>
<div class="line"><span class="lineno">  378</span> </div>
<div class="line"><span class="lineno">  379</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/df8/master__parameters_8hpp.html#afab5195e3ffff420d211040e5672fcbe">KELDYSH</a>){</div>
<div class="line"><span class="lineno">  380</span>        <span class="comment">// Keldysh components of the vertex needed for retarded and Keldysh self-energy</span></div>
<div class="line"><span class="lineno">  381</span>        std::vector&lt;std::vector&lt;int&gt; &gt; components {{3, 6, 7}, {1, 4, 5}};</div>
<div class="line"><span class="lineno">  382</span> </div>
<div class="line"><span class="lineno">  383</span>        <span class="comment">// determine the value of the vertex in the tails (only Gamma_0, K1t(w = 0), and K2&#39;t(w = 0, v&#39; = v) contribute!)</span></div>
<div class="line"><span class="lineno">  384</span>        <a class="code hl_struct" href="../../d2/db2/structVertexInput.html">VertexInput</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">inputRetarded</a> (components[iK][0], <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">ispin</a>, 0., 0., v, i_in, <span class="charliteral">&#39;t&#39;</span>);</div>
<div class="line"><span class="lineno">  385</span>        <a class="code hl_struct" href="../../d2/db2/structVertexInput.html">VertexInput</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">inputAdvanced</a> (components[iK][1], <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">ispin</a>, 0., 0., v, i_in, <span class="charliteral">&#39;t&#39;</span>);</div>
<div class="line"><span class="lineno">  386</span>        <a class="code hl_struct" href="../../d2/db2/structVertexInput.html">VertexInput</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">inputKeldysh</a>  (components[iK][2], <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">ispin</a>, 0., 0., v, i_in, <span class="charliteral">&#39;t&#39;</span>);</div>
<div class="line"><span class="lineno">  387</span>        Q <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">factorRetarded</a> = vertex.irred().val(components[iK][0], i_in, 0) <span class="comment">// Gamma_0</span></div>
<div class="line"><span class="lineno">  388</span>                           + vertex.tvertex().left_same_bare(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">inputRetarded</a>, vertex.avertex()); <span class="comment">// K1t(0) + K2&#39;t(0,v)</span></div>
<div class="line"><span class="lineno">  389</span>        Q <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">factorAdvanced</a> = vertex.irred().val(components[iK][1], i_in, 0) <span class="comment">// Gamma_0</span></div>
<div class="line"><span class="lineno">  390</span>                           + vertex.tvertex().left_same_bare(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">inputAdvanced</a>, vertex.avertex()); <span class="comment">// K1t(0) + K2&#39;t(0,v)</span></div>
<div class="line"><span class="lineno">  391</span>        Q <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">factorKeldysh</a>  = vertex.irred().val(components[iK][2], i_in, 0) <span class="comment">// Gamma_0</span></div>
<div class="line"><span class="lineno">  392</span>                           + vertex.tvertex().left_same_bare(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">inputKeldysh</a>, vertex.avertex()); <span class="comment">// K1t(0) + K2&#39;t(0,v)</span></div>
<div class="line"><span class="lineno">  393</span> </div>
<div class="line"><span class="lineno">  394</span>        <span class="comment">// if spin sum is performed, add contribution of all-spins-equal vertex: V -&gt; 2*V + V^</span></div>
<div class="line"><span class="lineno">  395</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">all_spins</a>) {</div>
<div class="line"><span class="lineno">  396</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">factorRetarded</a> *= 2.;</div>
<div class="line"><span class="lineno">  397</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">factorAdvanced</a> *= 2.;</div>
<div class="line"><span class="lineno">  398</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">factorKeldysh</a>  *= 2.;</div>
<div class="line"><span class="lineno">  399</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">inputRetarded</a>.spin = 1;</div>
<div class="line"><span class="lineno">  400</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">inputAdvanced</a>.spin = 1;</div>
<div class="line"><span class="lineno">  401</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">inputKeldysh</a>.spin  = 1;</div>
<div class="line"><span class="lineno">  402</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">factorRetarded</a> += vertex.irred().val(components[iK][0], i_in, 1) <span class="comment">// Gamma_0</span></div>
<div class="line"><span class="lineno">  403</span>                              + vertex.tvertex().left_same_bare(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">inputRetarded</a>, vertex.avertex()); <span class="comment">// K1t(0) + K2&#39;t(0,v)</span></div>
<div class="line"><span class="lineno">  404</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">factorAdvanced</a> += vertex.irred().val(components[iK][1], i_in, 1) <span class="comment">// Gamma_0</span></div>
<div class="line"><span class="lineno">  405</span>                              + vertex.tvertex().left_same_bare(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">inputAdvanced</a>, vertex.avertex()); <span class="comment">// K1t(0) + K2&#39;t(0,v)</span></div>
<div class="line"><span class="lineno">  406</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">factorKeldysh</a>  += vertex.irred().val(components[iK][2], i_in, 1) <span class="comment">// Gamma_0</span></div>
<div class="line"><span class="lineno">  407</span>                              + vertex.tvertex().left_same_bare(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">inputKeldysh</a>, vertex.avertex()); <span class="comment">// K1t(0) + K2&#39;t(0,v)</span></div>
<div class="line"><span class="lineno">  408</span>        }</div>
<div class="line"><span class="lineno">  409</span> </div>
<div class="line"><span class="lineno">  410</span>        <span class="comment">// analytical integration of the propagator</span></div>
<div class="line"><span class="lineno">  411</span>        Q GR = <a class="code hl_function" href="../../d0/d0e/loop__corrections_8hpp.html#abbe7409d3b32cbd812c187aa89745a83">correctionFunctionSelfEnergy</a>(0, vmin, vmax, G.<a class="code hl_variable" href="../../d2/d34/classPropagator.html#a1c8a818bc4c60992c78e93a8782e5e46">epsilon</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_H</a>, Delta, G.<a class="code hl_variable" href="../../d2/d34/classPropagator.html#a31d81f345df1e2eb6e4349e6d52252fb">type</a>);</div>
<div class="line"><span class="lineno">  412</span>        Q <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">GA</a> = <a class="code hl_function" href="../../d0/d0e/loop__corrections_8hpp.html#abbe7409d3b32cbd812c187aa89745a83">correctionFunctionSelfEnergy</a>(1, vmin, vmax, G.<a class="code hl_variable" href="../../d2/d34/classPropagator.html#a1c8a818bc4c60992c78e93a8782e5e46">epsilon</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_H</a>, Delta, G.<a class="code hl_variable" href="../../d2/d34/classPropagator.html#a31d81f345df1e2eb6e4349e6d52252fb">type</a>);</div>
<div class="line"><span class="lineno">  413</span>        Q GK = <a class="code hl_function" href="../../d0/d0e/loop__corrections_8hpp.html#abbe7409d3b32cbd812c187aa89745a83">correctionFunctionSelfEnergy</a>(2, vmin, vmax, G.<a class="code hl_variable" href="../../d2/d34/classPropagator.html#a1c8a818bc4c60992c78e93a8782e5e46">epsilon</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_H</a>, Delta, G.<a class="code hl_variable" href="../../d2/d34/classPropagator.html#a31d81f345df1e2eb6e4349e6d52252fb">type</a>);</div>
<div class="line"><span class="lineno">  414</span> </div>
<div class="line"><span class="lineno">  415</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">factorRetarded</a> * GR + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">factorAdvanced</a> * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">GA</a> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">factorKeldysh</a> * GK;</div>
<div class="line"><span class="lineno">  416</span>    }</div>
<div class="line"><span class="lineno">  417</span>    <span class="keywordflow">else</span>{</div>
<div class="line"><span class="lineno">  418</span>        <span class="comment">// determine the value of the vertex in the tails (only Gamma_0, K1t(w = 0), and K2&#39;t(w = 0, v&#39; = v) contribute!)</span></div>
<div class="line"><span class="lineno">  419</span>        <a class="code hl_struct" href="../../d2/db2/structVertexInput.html">VertexInput</a> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input</a> (0, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">ispin</a>, 0., 0., v, i_in, <span class="charliteral">&#39;t&#39;</span>);</div>
<div class="line"><span class="lineno">  420</span>        Q <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Vertexfactor</a> = vertex.irred().val(0, i_in, 0) <span class="comment">// Gamma_0</span></div>
<div class="line"><span class="lineno">  421</span>                         + vertex.tvertex().left_same_bare(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input</a>, vertex.avertex()); <span class="comment">// K1t(0) + K2&#39;t(0,v)</span></div>
<div class="line"><span class="lineno">  422</span> </div>
<div class="line"><span class="lineno">  423</span>        <span class="comment">// if spin sum is performed, add contribution of all-spins-equal vertex: V -&gt; 2*V + V^</span></div>
<div class="line"><span class="lineno">  424</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">all_spins</a>) {</div>
<div class="line"><span class="lineno">  425</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Vertexfactor</a> *= 2.;</div>
<div class="line"><span class="lineno">  426</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input</a>.spin = 1;</div>
<div class="line"><span class="lineno">  427</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Vertexfactor</a> += vertex.tvertex().left_same_bare(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">input</a>, vertex.avertex());</div>
<div class="line"><span class="lineno">  428</span>        }</div>
<div class="line"><span class="lineno">  429</span>        <span class="comment">// analytical integration of the propagator</span></div>
<div class="line"><span class="lineno">  430</span>        Q <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gfactor</a> = <a class="code hl_function" href="../../d0/d0e/loop__corrections_8hpp.html#abbe7409d3b32cbd812c187aa89745a83">correctionFunctionSelfEnergy</a>(0, vmin, vmax, G.<a class="code hl_variable" href="../../d2/d34/classPropagator.html#a1c8a818bc4c60992c78e93a8782e5e46">epsilon</a>, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Sigma_H</a>, Delta, G.<a class="code hl_variable" href="../../d2/d34/classPropagator.html#a31d81f345df1e2eb6e4349e6d52252fb">type</a>);</div>
<div class="line"><span class="lineno">  431</span> </div>
<div class="line"><span class="lineno">  432</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Vertexfactor</a> * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Gfactor</a>;</div>
<div class="line"><span class="lineno">  433</span>    }</div>
<div class="line"><span class="lineno">  434</span>}</div>
<div class="ttc" id="aclassPropagator_html_a1c8a818bc4c60992c78e93a8782e5e46"><div class="ttname"><a href="../../d2/d34/classPropagator.html#a1c8a818bc4c60992c78e93a8782e5e46">Propagator::epsilon</a></div><div class="ttdeci">const double epsilon</div><div class="ttdef"><b>Definition</b> <a href="../../d5/df7/propagator_8hpp_source.html#l00038">propagator.hpp:38</a></div></div>
<div class="ttc" id="aclassPropagator_html_a31d81f345df1e2eb6e4349e6d52252fb"><div class="ttname"><a href="../../d2/d34/classPropagator.html#a31d81f345df1e2eb6e4349e6d52252fb">Propagator::type</a></div><div class="ttdeci">const char type</div><div class="ttdef"><b>Definition</b> <a href="../../d5/df7/propagator_8hpp_source.html#l00037">propagator.hpp:37</a></div></div>
<div class="ttc" id="aloop__corrections_8hpp_html_abbe7409d3b32cbd812c187aa89745a83"><div class="ttname"><a href="../../d0/d0e/loop__corrections_8hpp.html#abbe7409d3b32cbd812c187aa89745a83">correctionFunctionSelfEnergy</a></div><div class="ttdeci">auto correctionFunctionSelfEnergy(int iK, double vmin, double vmax, double epsilon, Q Sigma_H, double Delta, char type) -&gt; Q</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d0e/loop__corrections_8hpp_source.html#l00083">loop_corrections.hpp:83</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/dea/bubble__corrections_8hpp_source.html#l00295">correctionFunctionBubble_REG3_Matsubara_PHS_diff()</a>, <a class="el" href="../../d0/d0e/loop__corrections_8hpp_source.html#l00083">correctionFunctionSelfEnergy()</a>, and <a class="el" href="../../d1/df8/master__parameters_8hpp_source.html#l00137">KELDYSH</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_ec91f0544e2a178672ced2e875bd1117.html">asymptotic_corrections</a></li><li class="navelem"><a class="el" href="../../d2/df0/correction__functions_8hpp.html">correction_functions.hpp</a></li>
    <li class="footer">Generated on Thu May 2 2024 15:26:53 for SIAM-Keldysh-mfRG by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
