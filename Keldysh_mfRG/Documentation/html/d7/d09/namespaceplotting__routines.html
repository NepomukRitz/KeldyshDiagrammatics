<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SIAM-Keldysh-mfRG: plotting_routines Namespace Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">SIAM-Keldysh-mfRG
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d7/d09/namespaceplotting__routines.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">plotting_routines Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7cc2bc58a20953150c0143c53ddbd92e" id="r_a7cc2bc58a20953150c0143c53ddbd92e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7cc2bc58a20953150c0143c53ddbd92e">effec_distribution</a> (v, T, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">stat</a>)</td></tr>
<tr class="separator:a7cc2bc58a20953150c0143c53ddbd92e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6609dd8d76efb7cd89f61e80f8f55dc" id="r_ab6609dd8d76efb7cd89f61e80f8f55dc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab6609dd8d76efb7cd89f61e80f8f55dc">generate_Keldysh_component</a> (<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">Im_X</a>, v, T, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">stat</a>)</td></tr>
<tr class="separator:ab6609dd8d76efb7cd89f61e80f8f55dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af65af7c5e8113ae01d07af1063e05a01" id="r_af65af7c5e8113ae01d07af1063e05a01"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af65af7c5e8113ae01d07af1063e05a01">generate_filename_fRG</a> (<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">path</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">diagClass</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">nLoops</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">n1</a>=301, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">sf</a>=<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">False</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">n2</a>=201, Gamma=1./3., <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">V</a>=0.0, T=0.01, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">L_ini</a>=1000, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">nODE</a>=50)</td></tr>
<tr class="separator:af65af7c5e8113ae01d07af1063e05a01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe68382e5921cbad602577447e4cc000" id="r_abe68382e5921cbad602577447e4cc000"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abe68382e5921cbad602577447e4cc000">change_prefix</a> (<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">path</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">prefix</a>, filename)</td></tr>
<tr class="separator:abe68382e5921cbad602577447e4cc000"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46c974daa3dcc27042323716519730ae" id="r_a46c974daa3dcc27042323716519730ae"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a46c974daa3dcc27042323716519730ae">generate_label</a> (<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">path_fRG</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">filenames</a>)</td></tr>
<tr class="separator:a46c974daa3dcc27042323716519730ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ce053a0fa97847059c202c08bcc38b3" id="r_a9ce053a0fa97847059c202c08bcc38b3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9ce053a0fa97847059c202c08bcc38b3">plot_fRG</a> (<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typ</a>, iK, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">filenames</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">labels</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">NRG_info</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">inset</a>)</td></tr>
<tr class="separator:a9ce053a0fa97847059c202c08bcc38b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ce446ebee719c7e343ac7956d35edb2" id="r_a7ce446ebee719c7e343ac7956d35edb2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7ce446ebee719c7e343ac7956d35edb2">plot_fRG_V_runs</a> (<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">typ</a>, iK, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">filenames</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">NRG_info</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">labels</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">run</a>, <a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">kind</a>)</td></tr>
<tr class="separator:a7ce446ebee719c7e343ac7956d35edb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab50a9ace2cb6e84d44537ed0579d4aac" id="r_ab50a9ace2cb6e84d44537ed0579d4aac"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab50a9ace2cb6e84d44537ed0579d4aac">plot_selfenergy</a> (filename, cnt, fs, *<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">args</a>)</td></tr>
<tr class="separator:ab50a9ace2cb6e84d44537ed0579d4aac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c84c11834d1694cb8c8a01f2708c49a" id="r_a9c84c11834d1694cb8c8a01f2708c49a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9c84c11834d1694cb8c8a01f2708c49a">plot_spectralfunction</a> (filename, fs, *<a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">args</a>)</td></tr>
<tr class="separator:a9c84c11834d1694cb8c8a01f2708c49a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0affc5ba7b10820ddde990876f351c5f" id="r_a0affc5ba7b10820ddde990876f351c5f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0affc5ba7b10820ddde990876f351c5f">usetex</a></td></tr>
<tr class="separator:a0affc5ba7b10820ddde990876f351c5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f0c8f313a1e10600e37d7bc975932fa" id="r_a1f0c8f313a1e10600e37d7bc975932fa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1f0c8f313a1e10600e37d7bc975932fa">family</a></td></tr>
<tr class="separator:a1f0c8f313a1e10600e37d7bc975932fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="abe68382e5921cbad602577447e4cc000" name="abe68382e5921cbad602577447e4cc000"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe68382e5921cbad602577447e4cc000">&#9670;&#160;</a></span>change_prefix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">plotting_routines.change_prefix </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>path</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>prefix</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>filename</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/de8/ipynb__scripts_2plotting__routines_8py_source.html#l00052">52</a> of file <a class="el" href="../../db/de8/ipynb__scripts_2plotting__routines_8py_source.html">ipynb_scripts/plotting_routines.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   52</span><span class="keyword">def </span>change_prefix(path, prefix, filename):</div>
<div class="line"><span class="lineno">   53</span>    s = list(filename)</div>
<div class="line"><span class="lineno">   54</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">s.insert</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">len</a>(path), prefix)</div>
<div class="line"><span class="lineno">   55</span>    filename = <span class="stringliteral">&quot;&quot;</span>.<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">join</a>(s)</div>
<div class="line"><span class="lineno">   56</span>    <span class="keywordflow">return</span> filename</div>
<div class="line"><span class="lineno">   57</span> </div>
<div class="ttc" id="abubble__corrections_8hpp_html_aff27784f97591f505f77ff0065ab57af"><div class="ttname"><a href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">correctionFunctionBubble_REG3_Matsubara_PHS_diff</a></div><div class="ttdeci">auto correctionFunctionBubble_REG3_Matsubara_PHS_diff(double w, double vmax, double Lambda, const double Delta)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dea/bubble__corrections_8hpp_source.html#l00295">bubble_corrections.hpp:295</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/dea/bubble__corrections_8hpp_source.html#l00295">correctionFunctionBubble_REG3_Matsubara_PHS_diff()</a>.</p>

</div>
</div>
<a id="a7cc2bc58a20953150c0143c53ddbd92e" name="a7cc2bc58a20953150c0143c53ddbd92e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cc2bc58a20953150c0143c53ddbd92e">&#9670;&#160;</a></span>effec_distribution()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">plotting_routines.effec_distribution </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>v</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>T</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>stat</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/de8/ipynb__scripts_2plotting__routines_8py_source.html#l00015">15</a> of file <a class="el" href="../../db/de8/ipynb__scripts_2plotting__routines_8py_source.html">ipynb_scripts/plotting_routines.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   15</span><span class="keyword">def </span>effec_distribution(v, T, stat):</div>
<div class="line"><span class="lineno">   16</span>    <span class="comment">#stat is either =-1 for fermionic statistics or =+1 for bosonic statistics</span></div>
<div class="line"><span class="lineno">   17</span>    res = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.power</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.tanh</a>(v/(2.*T)), -stat)</div>
<div class="line"><span class="lineno">   18</span>    <span class="keywordflow">if</span> stat == +1:</div>
<div class="line"><span class="lineno">   19</span>        indices = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.where</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.abs</a>(res) &gt; 10)[0]</div>
<div class="line"><span class="lineno">   20</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> indices:</div>
<div class="line"><span class="lineno">   21</span>            res[i] = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.sign</a>(res[i])*10</div>
<div class="line"><span class="lineno">   22</span>    <span class="keywordflow">return</span> res</div>
<div class="line"><span class="lineno">   23</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/dea/bubble__corrections_8hpp_source.html#l00295">correctionFunctionBubble_REG3_Matsubara_PHS_diff()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/de8/ipynb__scripts_2plotting__routines_8py_source.html#l00024">generate_Keldysh_component()</a>.</p>

</div>
</div>
<a id="af65af7c5e8113ae01d07af1063e05a01" name="af65af7c5e8113ae01d07af1063e05a01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af65af7c5e8113ae01d07af1063e05a01">&#9670;&#160;</a></span>generate_filename_fRG()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">plotting_routines.generate_filename_fRG </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>path</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>diagClass</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>nLoops</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>n1</em><span class="paramdefsep"> = </span><span class="paramdefval">301</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>sf</em><span class="paramdefsep"> = </span><span class="paramdefval"><a class="el" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">False</a></span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>n2</em><span class="paramdefsep"> = </span><span class="paramdefval">201</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>Gamma</em><span class="paramdefsep"> = </span><span class="paramdefval">1./3.</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>V</em><span class="paramdefsep"> = </span><span class="paramdefval">0.0</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>T</em><span class="paramdefsep"> = </span><span class="paramdefval">0.01</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>L_ini</em><span class="paramdefsep"> = </span><span class="paramdefval">1000</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>nODE</em><span class="paramdefsep"> = </span><span class="paramdefval">50</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/de8/ipynb__scripts_2plotting__routines_8py_source.html#l00029">29</a> of file <a class="el" href="../../db/de8/ipynb__scripts_2plotting__routines_8py_source.html">ipynb_scripts/plotting_routines.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   29</span><span class="keyword">def </span>generate_filename_fRG(path, diagClass, nLoops, n1=301, sf=False, n2=201, Gamma=1./3., V=0.0, T=0.01, L_ini=1000, nODE=50):</div>
<div class="line"><span class="lineno">   30</span>    </div>
<div class="line"><span class="lineno">   31</span>    Gamma_str = <span class="stringliteral">&quot;%.6f&quot;</span> % Gamma</div>
<div class="line"><span class="lineno">   32</span>    V_str = <span class="stringliteral">&quot;%.6f&quot;</span> % V</div>
<div class="line"><span class="lineno">   33</span>    T_str = <span class="stringliteral">&quot;%.6f&quot;</span> % T</div>
<div class="line"><span class="lineno">   34</span>    </div>
<div class="line"><span class="lineno">   35</span>    filename = <span class="stringliteral">&quot;K&quot;</span> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">str</a>(diagClass) + <span class="stringliteral">&quot;_&quot;</span> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">str</a>(nLoops) + <span class="stringliteral">&quot;LF_n1=&quot;</span> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">str</a>(n1)+<span class="stringliteral">&quot;_&quot;</span></div>
<div class="line"><span class="lineno">   36</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">if</a>(sf):</div>
<div class="line"><span class="lineno">   37</span>        filename += <span class="stringliteral">&quot;static_&quot;</span></div>
<div class="line"><span class="lineno">   38</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">elif</a>(diagClass&gt;1):</div>
<div class="line"><span class="lineno">   39</span>        filename += <span class="stringliteral">&quot;n2=&quot;</span> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">str</a>(n2) + <span class="stringliteral">&quot;_&quot;</span></div>
<div class="line"><span class="lineno">   40</span>        </div>
<div class="line"><span class="lineno">   41</span>    filename += <span class="stringliteral">&quot;Gamma=&quot;</span> + Gamma_str + <span class="stringliteral">&quot;_&quot;</span></div>
<div class="line"><span class="lineno">   42</span>    </div>
<div class="line"><span class="lineno">   43</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">if</a>(V!=0.0):</div>
<div class="line"><span class="lineno">   44</span>        filename += <span class="stringliteral">&quot;V=&quot;</span> + V_str + <span class="stringliteral">&quot;_&quot;</span></div>
<div class="line"><span class="lineno">   45</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">if</a>(T!= 0.01):</div>
<div class="line"><span class="lineno">   46</span>        filename += <span class="stringliteral">&quot;T=&quot;</span> + T_str + <span class="stringliteral">&quot;_&quot;</span></div>
<div class="line"><span class="lineno">   47</span>        </div>
<div class="line"><span class="lineno">   48</span>    filename += <span class="stringliteral">&quot;L_ini=&quot;</span> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">str</a>(L_ini) + <span class="stringliteral">&quot;_&quot;</span> + <span class="stringliteral">&quot;nODE=&quot;</span> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">str</a>(nODE) + <span class="stringliteral">&quot;.h5&quot;</span></div>
<div class="line"><span class="lineno">   49</span>    </div>
<div class="line"><span class="lineno">   50</span>    <span class="keywordflow">return</span> path + filename</div>
<div class="line"><span class="lineno">   51</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/dea/bubble__corrections_8hpp_source.html#l00295">correctionFunctionBubble_REG3_Matsubara_PHS_diff()</a>.</p>

</div>
</div>
<a id="ab6609dd8d76efb7cd89f61e80f8f55dc" name="ab6609dd8d76efb7cd89f61e80f8f55dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6609dd8d76efb7cd89f61e80f8f55dc">&#9670;&#160;</a></span>generate_Keldysh_component()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">plotting_routines.generate_Keldysh_component </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>Im_X</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>v</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>T</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>stat</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/de8/ipynb__scripts_2plotting__routines_8py_source.html#l00024">24</a> of file <a class="el" href="../../db/de8/ipynb__scripts_2plotting__routines_8py_source.html">ipynb_scripts/plotting_routines.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   24</span><span class="keyword">def </span>generate_Keldysh_component(Im_X, v, T, stat):</div>
<div class="line"><span class="lineno">   25</span>    <span class="comment">#X is retarded component of object</span></div>
<div class="line"><span class="lineno">   26</span>    <span class="keywordflow">return</span> 2.*Im_X*effec_distribution(v, T, stat)</div>
<div class="line"><span class="lineno">   27</span>    </div>
<div class="line"><span class="lineno">   28</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../db/de8/ipynb__scripts_2plotting__routines_8py_source.html#l00015">effec_distribution()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/de8/ipynb__scripts_2plotting__routines_8py_source.html#l00074">plot_fRG()</a>, and <a class="el" href="../../db/de8/ipynb__scripts_2plotting__routines_8py_source.html#l00389">plot_fRG_V_runs()</a>.</p>

</div>
</div>
<a id="a46c974daa3dcc27042323716519730ae" name="a46c974daa3dcc27042323716519730ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46c974daa3dcc27042323716519730ae">&#9670;&#160;</a></span>generate_label()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">plotting_routines.generate_label </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>path_fRG</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>filenames</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/de8/ipynb__scripts_2plotting__routines_8py_source.html#l00058">58</a> of file <a class="el" href="../../db/de8/ipynb__scripts_2plotting__routines_8py_source.html">ipynb_scripts/plotting_routines.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   58</span><span class="keyword">def </span>generate_label(path_fRG, filenames):</div>
<div class="line"><span class="lineno">   59</span>    labels = [] </div>
<div class="line"><span class="lineno">   60</span>    </div>
<div class="line"><span class="lineno">   61</span>    <span class="keywordflow">for</span> filename <span class="keywordflow">in</span> filenames:</div>
<div class="line"><span class="lineno">   62</span>        diag_class = filename[<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">len</a>(path_fRG)+1]</div>
<div class="line"><span class="lineno">   63</span>        label = <span class="stringliteral">r&#39;$\mathcal{K}_&#39;</span> + diag_class + <span class="stringliteral">&#39;$&#39;</span></div>
<div class="line"><span class="lineno">   64</span>        <span class="keywordflow">if</span> (filename[<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">len</a>(path_fRG)+14 : <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">len</a>(path_fRG)+20] == <span class="stringliteral">&#39;static&#39;</span>):</div>
<div class="line"><span class="lineno">   65</span>            label +=<span class="stringliteral">&#39; -- sf&#39;</span></div>
<div class="line"><span class="lineno">   66</span>        </div>
<div class="line"><span class="lineno">   67</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">elif</a>(diag_class == <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">str</a>(2)):</div>
<div class="line"><span class="lineno">   68</span>            label += <span class="stringliteral">&#39; &#39;</span> + filename[<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">len</a>(path_fRG)+3] + <span class="stringliteral">&#39;-loop&#39;</span></div>
<div class="line"><span class="lineno">   69</span>            </div>
<div class="line"><span class="lineno">   70</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">labels.append</a>(label)</div>
<div class="line"><span class="lineno">   71</span>    <span class="keywordflow">return</span> labels</div>
<div class="line"><span class="lineno">   72</span> </div>
<div class="line"><span class="lineno">   73</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/dea/bubble__corrections_8hpp_source.html#l00295">correctionFunctionBubble_REG3_Matsubara_PHS_diff()</a>.</p>

</div>
</div>
<a id="a9ce053a0fa97847059c202c08bcc38b3" name="a9ce053a0fa97847059c202c08bcc38b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ce053a0fa97847059c202c08bcc38b3">&#9670;&#160;</a></span>plot_fRG()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">plotting_routines.plot_fRG </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>typ</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>iK</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>filenames</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>labels</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>NRG_info</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>inset</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/de8/ipynb__scripts_2plotting__routines_8py_source.html#l00074">74</a> of file <a class="el" href="../../db/de8/ipynb__scripts_2plotting__routines_8py_source.html">ipynb_scripts/plotting_routines.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   74</span><span class="keyword">def </span>plot_fRG(typ, iK, filenames, labels, NRG_info, inset):</div>
<div class="line"><span class="lineno">   75</span>    U_NRG = NRG_info[0]</div>
<div class="line"><span class="lineno">   76</span>    path_NRG = NRG_info[1]</div>
<div class="line"><span class="lineno">   77</span>    possible_NRG = NRG_info[2]</div>
<div class="line"><span class="lineno">   78</span>    </div>
<div class="line"><span class="lineno">   79</span>    U_to_ins_ylim  = {0.1: 0.0001, 0.5:0.003, 1:0.008, 1.5: 0.02, 2:0.05, 2.5:0.07, 2.9:0.1, 3:0.1}</div>
<div class="line"><span class="lineno">   80</span>    U_str = <span class="stringliteral">&quot;%.1f&quot;</span> % (2*U_NRG)</div>
<div class="line"><span class="lineno">   81</span>    </div>
<div class="line"><span class="lineno">   82</span>    <span class="keywordflow">if</span> possible_NRG:</div>
<div class="line"><span class="lineno">   83</span>        <span class="comment"># load NRG reference data</span></div>
<div class="line"><span class="lineno">   84</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">   85</span>            plot_NRG=<span class="keyword">True</span></div>
<div class="line"><span class="lineno">   86</span>            Gamma_NRG, w_NRG, Aimp, SE_re, SE_im, K1a_re, K1a_im, K1p_re, K1p_im, K1t_re, K1t_im = load_SIAM_NRG(U_NRG,path_NRG)</div>
<div class="line"><span class="lineno">   87</span>            Delta_NRG = Gamma_NRG/2.</div>
<div class="line"><span class="lineno">   88</span>        </div>
<div class="line"><span class="lineno">   89</span>        <span class="keywordflow">except</span> KeyError:</div>
<div class="line"><span class="lineno">   90</span>            plot_NRG=<span class="keyword">False</span></div>
<div class="line"><span class="lineno">   91</span>            Delta_NRG=0.5</div>
<div class="line"><span class="lineno">   92</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">   93</span>        plot_NRG=<span class="keyword">False</span></div>
<div class="line"><span class="lineno">   94</span>        Delta_NRG=0.5</div>
<div class="line"><span class="lineno">   95</span>    </div>
<div class="line"><span class="lineno">   96</span>    </div>
<div class="line"><span class="lineno">   97</span>    <span class="comment"># load fRG data</span></div>
<div class="line"><span class="lineno">   98</span>    DIAG_CLASS, N_LOOPS, T, epsilon, mu, Gamma, Lambda, Delta, U, V, \</div>
<div class="line"><span class="lineno">   99</span>    v, Sigma, A, \</div>
<div class="line"><span class="lineno">  100</span>    w, K1a, K1p, K1t, \</div>
<div class="line"><span class="lineno">  101</span>    w2, v2, K2a, K2p, K2t \</div>
<div class="line"><span class="lineno">  102</span>        = load_data(U_NRG, Delta_NRG, filenames)</div>
<div class="line"><span class="lineno">  103</span>    </div>
<div class="line"><span class="lineno">  104</span>    K1_dic = {<span class="stringliteral">&#39;K1a&#39;</span>: K1a, <span class="stringliteral">&#39;K1p&#39;</span>: K1p, <span class="stringliteral">&#39;K1t&#39;</span>: K1t}</div>
<div class="line"><span class="lineno">  105</span>    </div>
<div class="line"><span class="lineno">  106</span>    fs = 34 <span class="comment"># font size</span></div>
<div class="line"><span class="lineno">  107</span>    fs_leg = 26</div>
<div class="line"><span class="lineno">  108</span>    fs_ticks = fs-4</div>
<div class="line"><span class="lineno">  109</span>    fs_ins = fs_leg</div>
<div class="line"><span class="lineno">  110</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">plt.rcParams</a>[<span class="stringliteral">&#39;legend.title_fontsize&#39;</span>] = 28</div>
<div class="line"><span class="lineno">  111</span>    </div>
<div class="line"><span class="lineno">  112</span>    size_a = (15,5)</div>
<div class="line"><span class="lineno">  113</span>    size_twocols = (15,5)</div>
<div class="line"><span class="lineno">  114</span>    </div>
<div class="line"><span class="lineno">  115</span>    lw = 5 <span class="comment">#linewidth</span></div>
<div class="line"><span class="lineno">  116</span>    </div>
<div class="line"><span class="lineno">  117</span>    lw_a = 3</div>
<div class="line"><span class="lineno">  118</span>    fs_a = 26 <span class="comment"># font size</span></div>
<div class="line"><span class="lineno">  119</span>    fs_leg_a = 22</div>
<div class="line"><span class="lineno">  120</span>    fs_ticks_a = fs-4</div>
<div class="line"><span class="lineno">  121</span>    fs_ins_a = fs_leg_a</div>
<div class="line"><span class="lineno">  122</span>    </div>
<div class="line"><span class="lineno">  123</span>    <span class="comment">#Plot spectral funciton</span></div>
<div class="line"><span class="lineno">  124</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">if</a>(typ[0]==<span class="stringliteral">&quot;A&quot;</span>):        </div>
<div class="line"><span class="lineno">  125</span>        fig, ax = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">plt.subplots</a>(figsize=size_a)</div>
<div class="line"><span class="lineno">  126</span> </div>
<div class="line"><span class="lineno">  127</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">len</a>(filenames)):</div>
<div class="line"><span class="lineno">  128</span>            <span class="keywordflow">if</span> (filenames[i][-43:-37] == <span class="stringliteral">&#39;static&#39;</span>):</div>
<div class="line"><span class="lineno">  129</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">ax.plot</a>(v[i]/Delta[i], A[i]*<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.pi</a>*Delta[i], <span class="stringliteral">&#39;.-&#39;</span>, label=labels[i], linewidth=lw_a*0.5)</div>
<div class="line"><span class="lineno">  130</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  131</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">ax.plot</a>(v[i]/Delta[i], A[i]*<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.pi</a>*Delta[i], <span class="stringliteral">&#39;.-&#39;</span>, label=labels[i], linewidth=lw_a)</div>
<div class="line"><span class="lineno">  132</span>            </div>
<div class="line"><span class="lineno">  133</span>        <span class="keywordflow">if</span> plot_NRG:    </div>
<div class="line"><span class="lineno">  134</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">ax.plot</a>(w_NRG/Delta_NRG, Aimp*<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.pi</a>*Delta_NRG, <span class="stringliteral">&#39;k:&#39;</span>, label=<span class="stringliteral">&#39;NRG&#39;</span>, linewidth=lw_a)    </div>
<div class="line"><span class="lineno">  135</span>            </div>
<div class="line"><span class="lineno">  136</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">ax.hlines</a>(1., -0.5, 0.5, linestyles=<span class="stringliteral">&#39;--&#39;</span>)</div>
<div class="line"><span class="lineno">  137</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">ax.set_ylabel</a>(<span class="stringliteral">r&#39;$\mathcal{A}(\nu)\pi\Delta$&#39;</span>, fontsize=fs)</div>
<div class="line"><span class="lineno">  138</span>        </div>
<div class="line"><span class="lineno">  139</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">ax.set_ylim</a>(-0.1, 1.15)</div>
<div class="line"><span class="lineno">  140</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">ax.set_xlim</a>(-5, 5)</div>
<div class="line"><span class="lineno">  141</span>        </div>
<div class="line"><span class="lineno">  142</span>        </div>
<div class="line"><span class="lineno">  143</span>                    </div>
<div class="line"><span class="lineno">  144</span>        <span class="keywordflow">if</span> inset:</div>
<div class="line"><span class="lineno">  145</span>            axins = zoomed_inset_axes(ax, 2.1, loc=2, borderpad = 4.5)</div>
<div class="line"><span class="lineno">  146</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.aspect</a>=<span class="stringliteral">&#39;equal&#39;</span></div>
<div class="line"><span class="lineno">  147</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.hlines</a>(1., -0.5, 0.5, linestyles=<span class="stringliteral">&#39;--&#39;</span>)</div>
<div class="line"><span class="lineno">  148</span>            <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">len</a>(filenames)):</div>
<div class="line"><span class="lineno">  149</span>                <span class="keywordflow">if</span> (filenames[i][-43:-37] == <span class="stringliteral">&#39;static&#39;</span>):                </div>
<div class="line"><span class="lineno">  150</span>                    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.plot</a>(v[i]/Delta[i], A[i]*<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.pi</a>*Delta[i], <span class="stringliteral">&#39;.-&#39;</span>, label=labels[i], linewidth=lw_a*0.5)</div>
<div class="line"><span class="lineno">  151</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  152</span>                    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.plot</a>(v[i]/Delta[i], A[i]*<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.pi</a>*Delta[i], <span class="stringliteral">&#39;.-&#39;</span>, label=labels[i], linewidth=lw_a)</div>
<div class="line"><span class="lineno">  153</span>            <span class="keywordflow">if</span> plot_NRG:    </div>
<div class="line"><span class="lineno">  154</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.plot</a>(w_NRG/Delta_NRG, Aimp*<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.pi</a>*Delta_NRG, <span class="stringliteral">&#39;k:&#39;</span>, label=<span class="stringliteral">&#39;NRG&#39;</span>, linewidth=lw_a)                      </div>
<div class="line"><span class="lineno">  155</span>                </div>
<div class="line"><span class="lineno">  156</span>                </div>
<div class="line"><span class="lineno">  157</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.set_ylim</a>(0.9, 1.1)</div>
<div class="line"><span class="lineno">  158</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.set_yticks</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.linspace</a>(0.9, 1.1, 3, endpoint=<span class="keyword">True</span>))    </div>
<div class="line"><span class="lineno">  159</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.set_xlim</a>(-0.4, 0.4)    </div>
<div class="line"><span class="lineno">  160</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.set_xticks</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.linspace</a>(-0.4, 0.4, 3, endpoint=<span class="keyword">True</span>))</div>
<div class="line"><span class="lineno">  161</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.tick_params</a>(axis=<span class="stringliteral">&#39;both&#39;</span>, labelsize=fs_ins_a)</div>
<div class="line"><span class="lineno">  162</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">plt.xticks</a>(visible=<span class="keyword">True</span>)  <span class="comment"># Present ticks</span></div>
<div class="line"><span class="lineno">  163</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">plt.yticks</a>(visible=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  164</span>            mark_inset(ax, axins, loc1=2, loc2=4, fc=<span class="stringliteral">&quot;none&quot;</span>, ec=<span class="stringliteral">&quot;0.5&quot;</span>)</div>
<div class="line"><span class="lineno">  165</span>    </div>
<div class="line"><span class="lineno">  166</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">ax.legend</a>(fontsize=fs_leg_a, title=<span class="stringliteral">r&#39;$U/\Delta=$&#39;</span> + U_str, frameon=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  167</span>        </div>
<div class="line"><span class="lineno">  168</span>        <span class="keywordflow">if</span> U_NRG==2.5:</div>
<div class="line"><span class="lineno">  169</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">ax.set_xlabel</a>(<span class="stringliteral">r&#39;$\nu/\Delta$&#39;</span>, fontsize=fs_a)</div>
<div class="line"><span class="lineno">  170</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">ax.tick_params</a>(axis=<span class="stringliteral">&#39;both&#39;</span>, labelsize=fs_ticks_a)</div>
<div class="line"><span class="lineno">  171</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  172</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">ax.axes.xaxis.set_visible</a>(<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  173</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">ax.tick_params</a>(axis=<span class="stringliteral">&#39;y&#39;</span>, labelsize=fs_ticks_a)</div>
<div class="line"><span class="lineno">  174</span>    </div>
<div class="line"><span class="lineno">  175</span>    <span class="comment">#Plot self energy, component iK</span></div>
<div class="line"><span class="lineno">  176</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">elif</a>(typ[0:4] == <span class="stringliteral">&quot;self&quot;</span>):</div>
<div class="line"><span class="lineno">  177</span>        fig, ax = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">plt.subplots</a>(nrows=1, ncols=2, figsize=size_twocols)</div>
<div class="line"><span class="lineno">  178</span>        </div>
<div class="line"><span class="lineno">  179</span> </div>
<div class="line"><span class="lineno">  180</span>        </div>
<div class="line"><span class="lineno">  181</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">len</a>(filenames)):</div>
<div class="line"><span class="lineno">  182</span>            <span class="keywordflow">if</span> (filenames[i][-43:-37] == <span class="stringliteral">&#39;static&#39;</span>):                </div>
<div class="line"><span class="lineno">  183</span>                ax[0].<a class="code hl_namespace" href="../../de/d73/namespaceplot.html">plot</a>(v[i]/Delta[i], Sigma[i][iK].real/Delta[i], <span class="stringliteral">&#39;.-&#39;</span>, label=labels[i], linewidth=lw*0.5)</div>
<div class="line"><span class="lineno">  184</span>                ax[1].<a class="code hl_namespace" href="../../de/d73/namespaceplot.html">plot</a>(v[i]/Delta[i], Sigma[i][iK].imag/Delta[i], <span class="stringliteral">&#39;.-&#39;</span>, label=labels[i], linewidth=lw*0.5)</div>
<div class="line"><span class="lineno">  185</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  186</span>                ax[0].<a class="code hl_namespace" href="../../de/d73/namespaceplot.html">plot</a>(v[i]/Delta[i], Sigma[i][iK].real/Delta[i], <span class="stringliteral">&#39;.-&#39;</span>, label=labels[i], linewidth=lw)</div>
<div class="line"><span class="lineno">  187</span>                ax[1].<a class="code hl_namespace" href="../../de/d73/namespaceplot.html">plot</a>(v[i]/Delta[i], Sigma[i][iK].imag/Delta[i], <span class="stringliteral">&#39;.-&#39;</span>, label=labels[i], linewidth=lw)</div>
<div class="line"><span class="lineno">  188</span>            </div>
<div class="line"><span class="lineno">  189</span>        <span class="keywordflow">if</span> plot_NRG:</div>
<div class="line"><span class="lineno">  190</span>            Re_X_NRG = (SE_re - U_NRG / 2) / Delta_NRG</div>
<div class="line"><span class="lineno">  191</span>            Im_X_NRG = SE_im / Delta_NRG</div>
<div class="line"><span class="lineno">  192</span>            <span class="keywordflow">if</span> iK == 1:</div>
<div class="line"><span class="lineno">  193</span>                Re_X_NRG = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.zeros</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">len</a>(w_NRG/Delta_NRG))</div>
<div class="line"><span class="lineno">  194</span>                Im_X_NRG = generate_Keldysh_component( Im_X_NRG, w_NRG / Delta_NRG, T[i], stat=-1)</div>
<div class="line"><span class="lineno">  195</span>            </div>
<div class="line"><span class="lineno">  196</span>            ax[0].<a class="code hl_namespace" href="../../de/d73/namespaceplot.html">plot</a>(w_NRG / Delta_NRG, Re_X_NRG, <span class="stringliteral">&#39;k:&#39;</span>, label=<span class="stringliteral">&#39;NRG&#39;</span>, linewidth=lw) </div>
<div class="line"><span class="lineno">  197</span>            ax[1].<a class="code hl_namespace" href="../../de/d73/namespaceplot.html">plot</a>(w_NRG / Delta_NRG, Im_X_NRG, <span class="stringliteral">&#39;k:&#39;</span>, label=<span class="stringliteral">&#39;NRG&#39;</span>, linewidth=lw) </div>
<div class="line"><span class="lineno">  198</span>            </div>
<div class="line"><span class="lineno">  199</span>            </div>
<div class="line"><span class="lineno">  200</span>        <span class="keywordflow">if</span> inset:</div>
<div class="line"><span class="lineno">  201</span>            axins = zoomed_inset_axes(ax[1], 7, loc=4, borderpad=2.5)</div>
<div class="line"><span class="lineno">  202</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.aspect</a>=<span class="stringliteral">&#39;equal&#39;</span></div>
<div class="line"><span class="lineno">  203</span>            <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">len</a>(filenames)):</div>
<div class="line"><span class="lineno">  204</span>                <span class="keywordflow">if</span> (filenames[i][-43:-37] == <span class="stringliteral">&#39;static&#39;</span>):                </div>
<div class="line"><span class="lineno">  205</span>                    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.plot</a>(v[i]/Delta[i], Sigma[i][iK].imag/Delta[i], <span class="stringliteral">&#39;.-&#39;</span>, label=labels[i], linewidth=lw*0.5)</div>
<div class="line"><span class="lineno">  206</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  207</span>                    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.plot</a>(v[i]/Delta[i], Sigma[i][iK].imag/Delta[i], <span class="stringliteral">&#39;.-&#39;</span>, label=labels[i], linewidth=lw)</div>
<div class="line"><span class="lineno">  208</span>            <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  209</span>                ylim = U_to_ins_ylim[U_NRG]</div>
<div class="line"><span class="lineno">  210</span>            <span class="keywordflow">except</span> KeyError:</div>
<div class="line"><span class="lineno">  211</span>                ylim = U_NRG/20</div>
<div class="line"><span class="lineno">  212</span>                </div>
<div class="line"><span class="lineno">  213</span>                </div>
<div class="line"><span class="lineno">  214</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.set_ylim</a>(-ylim, 0.2*ylim)</div>
<div class="line"><span class="lineno">  215</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.set_yticks</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.linspace</a>(-ylim, 0, 2, endpoint=<span class="keyword">True</span>))   </div>
<div class="line"><span class="lineno">  216</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.yaxis.set_major_formatter</a>(StrMethodFormatter(<span class="stringliteral">&#39;{x:,.2f}&#39;</span>)) <span class="comment"># Two decimal places</span></div>
<div class="line"><span class="lineno">  217</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.set_xlim</a>(-0.5, 0.5)    </div>
<div class="line"><span class="lineno">  218</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.set_xticks</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.linspace</a>(-0.5, 0.5, 3, endpoint=<span class="keyword">True</span>))</div>
<div class="line"><span class="lineno">  219</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.tick_params</a>(axis=<span class="stringliteral">&#39;both&#39;</span>, labelsize=fs_ins-4)</div>
<div class="line"><span class="lineno">  220</span> </div>
<div class="line"><span class="lineno">  221</span>            </div>
<div class="line"><span class="lineno">  222</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">plt.xticks</a>(visible=<span class="keyword">True</span>)  <span class="comment"># Present ticks</span></div>
<div class="line"><span class="lineno">  223</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">plt.yticks</a>(visible=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  224</span>            </div>
<div class="line"><span class="lineno">  225</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">if</a>(iK==0):</div>
<div class="line"><span class="lineno">  226</span>            ax[1].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">hlines</a>(0, -2, 2, linestyles=<span class="stringliteral">&#39;--&#39;</span>)</div>
<div class="line"><span class="lineno">  227</span>            <span class="keywordflow">if</span> plot_NRG <span class="keywordflow">and</span> inset:</div>
<div class="line"><span class="lineno">  228</span>                    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.plot</a>(w_NRG / Delta_NRG, SE_im / Delta_NRG, <span class="stringliteral">&#39;k:&#39;</span>, label=<span class="stringliteral">&#39;NRG&#39;</span>, linewidth=lw) </div>
<div class="line"><span class="lineno">  229</span>            <span class="keywordflow">if</span> inset:</div>
<div class="line"><span class="lineno">  230</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.hlines</a>(0, -2, 2, linestyles=<span class="stringliteral">&#39;--&#39;</span>)</div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span>            ax[0].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">set_ylabel</a>(<span class="stringliteral">&#39;$(\mathrm{Re}\Sigma^R-\Sigma^H)/\Delta$&#39;</span>, fontsize=fs+2)</div>
<div class="line"><span class="lineno">  233</span>            ax[1].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">set_ylabel</a>(<span class="stringliteral">&#39;$\mathrm{Im}\Sigma^R/\Delta$&#39;</span>, fontsize=fs+2)</div>
<div class="line"><span class="lineno">  234</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  235</span>            t = ax[0].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">yaxis.get_offset_text</a>()</div>
<div class="line"><span class="lineno">  236</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">t.set_size</a>(fs_leg)</div>
<div class="line"><span class="lineno">  237</span>            ax[0].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">set_ylabel</a>(<span class="stringliteral">&#39;$\mathrm{Re}\Sigma^K/\Delta$&#39;</span>, fontsize=fs+2)</div>
<div class="line"><span class="lineno">  238</span>            ax[1].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">set_ylabel</a>(<span class="stringliteral">&#39;$\mathrm{Im}\Sigma^K/\Delta$&#39;</span>, fontsize=fs+2)</div>
<div class="line"><span class="lineno">  239</span> </div>
<div class="line"><span class="lineno">  240</span>            </div>
<div class="line"><span class="lineno">  241</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">plt.tight_layout</a>(pad=4)</div>
<div class="line"><span class="lineno">  242</span>        </div>
<div class="line"><span class="lineno">  243</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(2):</div>
<div class="line"><span class="lineno">  244</span>            ax[i].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">set_xlim</a>(-20, 20)</div>
<div class="line"><span class="lineno">  245</span>            <span class="keywordflow">if</span> U_NRG==2.5:</div>
<div class="line"><span class="lineno">  246</span>                ax[i].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">set_xlabel</a>(<span class="stringliteral">r&#39;$\nu/\Delta$&#39;</span>, fontsize=fs+2)</div>
<div class="line"><span class="lineno">  247</span>                ax[i].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">tick_params</a>(axis=<span class="stringliteral">&#39;both&#39;</span>, labelsize=fs_ticks)</div>
<div class="line"><span class="lineno">  248</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  249</span>                ax[i].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axes.xaxis.set_visible</a>(<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  250</span>                ax[i].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">tick_params</a>(axis=<span class="stringliteral">&#39;y&#39;</span>, labelsize=fs_ticks)</div>
<div class="line"><span class="lineno">  251</span>            </div>
<div class="line"><span class="lineno">  252</span>            <span class="keywordflow">if</span> iK == 1:</div>
<div class="line"><span class="lineno">  253</span>                ax[1].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">yaxis.set_major_formatter</a>(StrMethodFormatter(<span class="stringliteral">&#39;{x:,.1f}&#39;</span>)) <span class="comment"># One decimal place</span></div>
<div class="line"><span class="lineno">  254</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  255</span>                ax[i].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">yaxis.set_major_formatter</a>(StrMethodFormatter(<span class="stringliteral">&#39;{x:,.1f}&#39;</span>)) <span class="comment"># One decimal place</span></div>
<div class="line"><span class="lineno">  256</span>                </div>
<div class="line"><span class="lineno">  257</span>        <span class="keywordflow">if</span> iK == 1:</div>
<div class="line"><span class="lineno">  258</span>            t = ax[0].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">yaxis.get_offset_text</a>()</div>
<div class="line"><span class="lineno">  259</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">t.set_size</a>(fs_leg)</div>
<div class="line"><span class="lineno">  260</span>            ax[0].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">legend</a>(fontsize=fs_leg, title=<span class="stringliteral">r&#39;$U/\Delta=$&#39;</span> + U_str)    </div>
<div class="line"><span class="lineno">  261</span>        </div>
<div class="line"><span class="lineno">  262</span>    <span class="comment">#Plot susceptibilities</span></div>
<div class="line"><span class="lineno">  263</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">elif</a>(typ[0:4] == <span class="stringliteral">&quot;susc&quot;</span>):    <span class="comment">#susceptibility</span></div>
<div class="line"><span class="lineno">  264</span>        fig, ax = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">plt.subplots</a>(nrows=1, ncols=2, figsize=size_twocols)</div>
<div class="line"><span class="lineno">  265</span>        sup_indices = [<span class="stringliteral">&#39;R&#39;</span>, <span class="stringliteral">&#39;K&#39;</span>]</div>
<div class="line"><span class="lineno">  266</span>        pfs = [-1, +1]</div>
<div class="line"><span class="lineno">  267</span>        susc = typ[5:7]</div>
<div class="line"><span class="lineno">  268</span>        <span class="keywordflow">if</span> susc==<span class="stringliteral">&quot;sp&quot;</span>:      <span class="comment">#spin susceptibility</span></div>
<div class="line"><span class="lineno">  269</span>            <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">len</a>(filenames)):</div>
<div class="line"><span class="lineno">  270</span>                <span class="keywordflow">if</span> (filenames[i][-43:-37] == <span class="stringliteral">&#39;static&#39;</span>):</div>
<div class="line"><span class="lineno">  271</span>                    ax[0].<a class="code hl_namespace" href="../../de/d73/namespaceplot.html">plot</a>(w[i] / Delta[i],  K1a[i][iK].real *<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.pi</a>* Delta[i], <span class="stringliteral">&#39;.-&#39;</span>, label=labels[i], linewidth=lw*0.5)</div>
<div class="line"><span class="lineno">  272</span>                    ax[1].<a class="code hl_namespace" href="../../de/d73/namespaceplot.html">plot</a>(w[i] / Delta[i], pfs[iK]*K1a[i][iK].imag *<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.pi</a>* Delta[i], <span class="stringliteral">&#39;.-&#39;</span>, label=labels[i], linewidth=lw*0.5)</div>
<div class="line"><span class="lineno">  273</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  274</span>                    ax[0].<a class="code hl_namespace" href="../../de/d73/namespaceplot.html">plot</a>(w[i] / Delta[i],  K1a[i][iK].real *<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.pi</a>* Delta[i], <span class="stringliteral">&#39;.-&#39;</span>, label=labels[i], linewidth=lw)</div>
<div class="line"><span class="lineno">  275</span>                    ax[1].<a class="code hl_namespace" href="../../de/d73/namespaceplot.html">plot</a>(w[i] / Delta[i], pfs[iK]*K1a[i][iK].imag *<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.pi</a>* Delta[i], <span class="stringliteral">&#39;.-&#39;</span>, label=labels[i], linewidth=lw)</div>
<div class="line"><span class="lineno">  276</span>                    </div>
<div class="line"><span class="lineno">  277</span>        <span class="keywordflow">elif</span> susc==<span class="stringliteral">&quot;ch&quot;</span>:        <span class="comment">#charge susceptibility</span></div>
<div class="line"><span class="lineno">  278</span>            <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">len</a>(filenames)):</div>
<div class="line"><span class="lineno">  279</span>                <span class="keywordflow">if</span> (filenames[i][-43:-37] == <span class="stringliteral">&#39;static&#39;</span>):</div>
<div class="line"><span class="lineno">  280</span>                    ax[0].<a class="code hl_namespace" href="../../de/d73/namespaceplot.html">plot</a>(w[i] / Delta[i], (2*K1t[i][iK]-K1a[i][iK]).real *<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.pi</a>* Delta[i], <span class="stringliteral">&#39;.-&#39;</span>, label=labels[i], linewidth=lw*0.5)</div>
<div class="line"><span class="lineno">  281</span>                    ax[1].<a class="code hl_namespace" href="../../de/d73/namespaceplot.html">plot</a>(w[i] / Delta[i], pfs[iK]*(2*K1t[i][iK]-K1a[i][iK]).imag *<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.pi</a>* Delta[i], <span class="stringliteral">&#39;.-&#39;</span>, label=labels[i], linewidth=lw*0.5)</div>
<div class="line"><span class="lineno">  282</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  283</span>                    ax[0].<a class="code hl_namespace" href="../../de/d73/namespaceplot.html">plot</a>(w[i] / Delta[i], (2*K1t[i][iK]-K1a[i][iK]).real *<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.pi</a>* Delta[i], <span class="stringliteral">&#39;.-&#39;</span>, label=labels[i], linewidth=lw) </div>
<div class="line"><span class="lineno">  284</span>                    ax[1].<a class="code hl_namespace" href="../../de/d73/namespaceplot.html">plot</a>(w[i] / Delta[i], pfs[iK]*(2*K1t[i][iK]-K1a[i][iK]).imag *<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.pi</a>* Delta[i], <span class="stringliteral">&#39;.-&#39;</span>, label=labels[i], linewidth=lw)</div>
<div class="line"><span class="lineno">  285</span>            </div>
<div class="line"><span class="lineno">  286</span>        <span class="keywordflow">if</span> plot_NRG:</div>
<div class="line"><span class="lineno">  287</span>            <span class="keywordflow">if</span> susc == <span class="stringliteral">&quot;sp&quot;</span>:</div>
<div class="line"><span class="lineno">  288</span>                Re_X_NRG = K1a_re </div>
<div class="line"><span class="lineno">  289</span>                Im_X_NRG = K1a_im </div>
<div class="line"><span class="lineno">  290</span>                </div>
<div class="line"><span class="lineno">  291</span>            <span class="keywordflow">elif</span> susc == <span class="stringliteral">&quot;ch&quot;</span>:</div>
<div class="line"><span class="lineno">  292</span>                Re_X_NRG = (2*K1t_re - K1a_re)</div>
<div class="line"><span class="lineno">  293</span>                Im_X_NRG = (2*K1t_im - K1a_im)</div>
<div class="line"><span class="lineno">  294</span>                </div>
<div class="line"><span class="lineno">  295</span>            <span class="keywordflow">if</span> iK == 1:</div>
<div class="line"><span class="lineno">  296</span>                Re_X_NRG = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.zeros</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">len</a>(w_NRG/Delta_NRG))</div>
<div class="line"><span class="lineno">  297</span>                Im_X_NRG = generate_Keldysh_component( Im_X_NRG, w_NRG, T[i], stat=+1)</div>
<div class="line"><span class="lineno">  298</span>                </div>
<div class="line"><span class="lineno">  299</span>            </div>
<div class="line"><span class="lineno">  300</span>            ax[0].<a class="code hl_namespace" href="../../de/d73/namespaceplot.html">plot</a>(w_NRG / Delta_NRG, Re_X_NRG * 2*U_NRG**2* <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.pi</a>*Delta[i]**2, <span class="stringliteral">&#39;k:&#39;</span>, label=<span class="stringliteral">&#39;NRG&#39;</span>, linewidth=lw)  </div>
<div class="line"><span class="lineno">  301</span>            ax[1].<a class="code hl_namespace" href="../../de/d73/namespaceplot.html">plot</a>(w_NRG / Delta_NRG, Im_X_NRG * 2*U_NRG**2* <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.pi</a>*Delta[i]**2, <span class="stringliteral">&#39;k:&#39;</span>, label=<span class="stringliteral">&#39;NRG&#39;</span>, linewidth=lw) </div>
<div class="line"><span class="lineno">  302</span>            </div>
<div class="line"><span class="lineno">  303</span>        </div>
<div class="line"><span class="lineno">  304</span>        ax[0].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">set_ylabel</a>(<span class="stringliteral">r&#39;$\mathrm{Re}\chi^&#39;</span>+ sup_indices[iK]+<span class="stringliteral">&#39;_\mathrm{&#39;</span>+susc+<span class="stringliteral">&#39;}\pi\Delta$&#39;</span>, fontsize=fs+2)</div>
<div class="line"><span class="lineno">  305</span>        ax[1].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">set_ylabel</a>(<span class="stringliteral">r&#39;$\mathrm{Im}\chi^&#39;</span>+ sup_indices[iK]+<span class="stringliteral">&#39;_\mathrm{&#39;</span>+susc+<span class="stringliteral">&#39;}\pi\Delta$&#39;</span>, fontsize=fs+2)</div>
<div class="line"><span class="lineno">  306</span>        </div>
<div class="line"><span class="lineno">  307</span>        </div>
<div class="line"><span class="lineno">  308</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">fig.tight_layout</a>(pad=4)  </div>
<div class="line"><span class="lineno">  309</span>    </div>
<div class="line"><span class="lineno">  310</span>        <span class="keywordflow">if</span> iK == 1:</div>
<div class="line"><span class="lineno">  311</span>            t = ax[0].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">yaxis.get_offset_text</a>()</div>
<div class="line"><span class="lineno">  312</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">t.set_size</a>(fs_leg)</div>
<div class="line"><span class="lineno">  313</span>            ax[0].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">legend</a>(fontsize=fs_leg, title=<span class="stringliteral">r&#39;$U/\Delta=$&#39;</span> + U_str)   </div>
<div class="line"><span class="lineno">  314</span>            </div>
<div class="line"><span class="lineno">  315</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(2):</div>
<div class="line"><span class="lineno">  316</span>            <span class="keywordflow">if</span> iK == 1:</div>
<div class="line"><span class="lineno">  317</span>                ax[0].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">yaxis.set_major_locator</a>(MaxNLocator(3, symmetric=<span class="keyword">True</span>))</div>
<div class="line"><span class="lineno">  318</span>                ax[1].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">yaxis.set_major_formatter</a>(StrMethodFormatter(<span class="stringliteral">&#39;{x:,.1f}&#39;</span>)) <span class="comment"># One decimal place</span></div>
<div class="line"><span class="lineno">  319</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  320</span>                ax[i].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">yaxis.set_major_formatter</a>(StrMethodFormatter(<span class="stringliteral">&#39;{x:,.1f}&#39;</span>)) <span class="comment"># One decimal place</span></div>
<div class="line"><span class="lineno">  321</span>            <span class="keywordflow">if</span> susc == <span class="stringliteral">&#39;sp&#39;</span>:</div>
<div class="line"><span class="lineno">  322</span>                ax[i].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">set_xlim</a>(-5,5)</div>
<div class="line"><span class="lineno">  323</span>            <span class="keywordflow">elif</span> susc == <span class="stringliteral">&#39;ch&#39;</span>:</div>
<div class="line"><span class="lineno">  324</span>                ax[i].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">set_xlim</a>(-10,10)</div>
<div class="line"><span class="lineno">  325</span>                </div>
<div class="line"><span class="lineno">  326</span>            <span class="keywordflow">if</span> U_NRG==2.5:</div>
<div class="line"><span class="lineno">  327</span>                ax[i].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">set_xlabel</a>(<span class="stringliteral">r&#39;$\omega/\Delta$&#39;</span>, fontsize=fs+2)</div>
<div class="line"><span class="lineno">  328</span>                ax[i].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">tick_params</a>(axis=<span class="stringliteral">&#39;both&#39;</span>, labelsize=fs_ticks)</div>
<div class="line"><span class="lineno">  329</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  330</span>                ax[i].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axes.xaxis.set_visible</a>(<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  331</span>                ax[i].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">tick_params</a>(axis=<span class="stringliteral">&#39;y&#39;</span>, labelsize=fs_ticks)</div>
<div class="line"><span class="lineno">  332</span>               </div>
<div class="line"><span class="lineno">  333</span> </div>
<div class="line"><span class="lineno">  334</span>    <span class="comment">#Plot vertex K1</span></div>
<div class="line"><span class="lineno">  335</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">elif</a>(typ[0:2] == <span class="stringliteral">&quot;K1&quot;</span>):    </div>
<div class="line"><span class="lineno">  336</span>        fig, ax = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">plt.subplots</a>(nrows=1, ncols=2, figsize=size_twocols)</div>
<div class="line"><span class="lineno">  337</span>        sup_indices = [<span class="stringliteral">&#39;R&#39;</span>, <span class="stringliteral">&#39;K&#39;</span>]</div>
<div class="line"><span class="lineno">  338</span>        r = typ[2]</div>
<div class="line"><span class="lineno">  339</span>        pfs = [-1, +1]</div>
<div class="line"><span class="lineno">  340</span>        K1 = K1_dic[typ]</div>
<div class="line"><span class="lineno">  341</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">len</a>(filenames)):</div>
<div class="line"><span class="lineno">  342</span>            <span class="keywordflow">if</span> (filenames[i][-43:-37] == <span class="stringliteral">&#39;static&#39;</span>):</div>
<div class="line"><span class="lineno">  343</span>                ax[0].<a class="code hl_namespace" href="../../de/d73/namespaceplot.html">plot</a>(w[i] / Delta[i], K1[i][iK].real, <span class="stringliteral">&#39;.-&#39;</span>, label=labels[i], linewidth=lw*0.5)</div>
<div class="line"><span class="lineno">  344</span>                ax[1].<a class="code hl_namespace" href="../../de/d73/namespaceplot.html">plot</a>(w[i] / Delta[i], pfs[iK]*K1[i][iK].imag, <span class="stringliteral">&#39;.-&#39;</span>, label=labels[i], linewidth=lw*0.5)</div>
<div class="line"><span class="lineno">  345</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  346</span>                ax[0].<a class="code hl_namespace" href="../../de/d73/namespaceplot.html">plot</a>(w[i] / Delta[i], K1[i][iK].real, <span class="stringliteral">&#39;.-&#39;</span>, label=labels[i], linewidth=lw)</div>
<div class="line"><span class="lineno">  347</span>                ax[1].<a class="code hl_namespace" href="../../de/d73/namespaceplot.html">plot</a>(w[i] / Delta[i], pfs[iK]*K1[i][iK].imag, <span class="stringliteral">&#39;.-&#39;</span>, label=labels[i], linewidth=lw)</div>
<div class="line"><span class="lineno">  348</span>            </div>
<div class="line"><span class="lineno">  349</span>        <span class="keywordflow">if</span> plot_NRG:</div>
<div class="line"><span class="lineno">  350</span>            <span class="keywordflow">if</span> r == <span class="stringliteral">&quot;a&quot;</span>:</div>
<div class="line"><span class="lineno">  351</span>                Re_X_NRG = K1a_re </div>
<div class="line"><span class="lineno">  352</span>                Im_X_NRG = K1a_im </div>
<div class="line"><span class="lineno">  353</span>                </div>
<div class="line"><span class="lineno">  354</span>            <span class="keywordflow">elif</span> r == <span class="stringliteral">&quot;p&quot;</span>:</div>
<div class="line"><span class="lineno">  355</span>                Re_X_NRG = K1p_re </div>
<div class="line"><span class="lineno">  356</span>                Im_X_NRG = K1p_im </div>
<div class="line"><span class="lineno">  357</span>                </div>
<div class="line"><span class="lineno">  358</span>            <span class="keywordflow">elif</span> r == <span class="stringliteral">&quot;t&quot;</span>:</div>
<div class="line"><span class="lineno">  359</span>                Re_X_NRG = K1t_re </div>
<div class="line"><span class="lineno">  360</span>                Im_X_NRG = K1t_im </div>
<div class="line"><span class="lineno">  361</span>                </div>
<div class="line"><span class="lineno">  362</span>            <span class="keywordflow">if</span> iK == 1:</div>
<div class="line"><span class="lineno">  363</span>                Re_X_NRG = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.zeros</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">len</a>(w_NRG/Delta_NRG))</div>
<div class="line"><span class="lineno">  364</span>                Im_X_NRG = generate_Keldysh_component(Im_X_NRG, w_NRG, T[i], stat=+1)</div>
<div class="line"><span class="lineno">  365</span>            </div>
<div class="line"><span class="lineno">  366</span>            ax[0].<a class="code hl_namespace" href="../../de/d73/namespaceplot.html">plot</a>(w_NRG / Delta_NRG, Re_X_NRG * (U_NRG)**2 / 2, <span class="stringliteral">&#39;k:&#39;</span>, label=<span class="stringliteral">&#39;NRG&#39;</span>)</div>
<div class="line"><span class="lineno">  367</span>            ax[1].<a class="code hl_namespace" href="../../de/d73/namespaceplot.html">plot</a>(w_NRG / Delta_NRG, Im_X_NRG * (U_NRG)**2 / 2, <span class="stringliteral">&#39;k:&#39;</span>, label=<span class="stringliteral">&#39;NRG&#39;</span>)</div>
<div class="line"><span class="lineno">  368</span>            </div>
<div class="line"><span class="lineno">  369</span>        </div>
<div class="line"><span class="lineno">  370</span>        ax[0].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">set_ylabel</a>(<span class="stringliteral">r&#39;$\mathrm{Re}{\mathcal{K}_1^&#39;</span>+ sup_indices[iK]+<span class="stringliteral">&#39;}_\mathrm{&#39;</span>+r+<span class="stringliteral">&#39;}$&#39;</span>, fontsize=fs)</div>
<div class="line"><span class="lineno">  371</span>        ax[1].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">set_ylabel</a>(<span class="stringliteral">r&#39;$\mathrm{Im}{\mathcal{K}_1^&#39;</span>+ sup_indices[iK]+<span class="stringliteral">&#39;}_\mathrm{&#39;</span>+r+<span class="stringliteral">&#39;}$&#39;</span>, fontsize=fs)</div>
<div class="line"><span class="lineno">  372</span>        </div>
<div class="line"><span class="lineno">  373</span> </div>
<div class="line"><span class="lineno">  374</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(2):</div>
<div class="line"><span class="lineno">  375</span>            ax[i].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">set_xlabel</a>(<span class="stringliteral">r&#39;$\omega/\Delta$&#39;</span>, fontsize=fs)</div>
<div class="line"><span class="lineno">  376</span>            <span class="keywordflow">if</span> r == <span class="stringliteral">&#39;a&#39;</span> <span class="keywordflow">or</span> <span class="stringliteral">&#39;t&#39;</span>:</div>
<div class="line"><span class="lineno">  377</span>                ax[i].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">set_xlim</a>(-5,5)</div>
<div class="line"><span class="lineno">  378</span>            <span class="keywordflow">elif</span> r == <span class="stringliteral">&#39;p&#39;</span>:</div>
<div class="line"><span class="lineno">  379</span>                ax[i].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">set_xlim</a>(-10,10)</div>
<div class="line"><span class="lineno">  380</span>            ax[i].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">tick_params</a>(axis=<span class="stringliteral">&#39;both&#39;</span>, labelsize=fs_ticks)</div>
<div class="line"><span class="lineno">  381</span>        ax[0].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">legend</a>(fontsize=fs_leg, title=<span class="stringliteral">r&#39;$U/\Delta=$&#39;</span> + U_str)</div>
<div class="line"><span class="lineno">  382</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">fig.tight_layout</a>() </div>
<div class="line"><span class="lineno">  383</span>        </div>
<div class="line"><span class="lineno">  384</span>    <span class="keywordflow">return</span> fig, ax</div>
<div class="line"><span class="lineno">  385</span> </div>
<div class="line"><span class="lineno">  386</span> </div>
<div class="line"><span class="lineno">  387</span> </div>
<div class="line"><span class="lineno">  388</span> </div>
<div class="ttc" id="anamespaceplot_html"><div class="ttname"><a href="../../de/d73/namespaceplot.html">plot</a></div><div class="ttdef"><b>Definition</b> <a href="../../db/d7a/plot_8py_source.html#l00001">plot.py:1</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/dea/bubble__corrections_8hpp_source.html#l00295">correctionFunctionBubble_REG3_Matsubara_PHS_diff()</a>, and <a class="el" href="../../db/de8/ipynb__scripts_2plotting__routines_8py_source.html#l00024">generate_Keldysh_component()</a>.</p>

</div>
</div>
<a id="a7ce446ebee719c7e343ac7956d35edb2" name="a7ce446ebee719c7e343ac7956d35edb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ce446ebee719c7e343ac7956d35edb2">&#9670;&#160;</a></span>plot_fRG_V_runs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">plotting_routines.plot_fRG_V_runs </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>typ</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>iK</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>filenames</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>NRG_info</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>labels</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>run</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>kind</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/de8/ipynb__scripts_2plotting__routines_8py_source.html#l00389">389</a> of file <a class="el" href="../../db/de8/ipynb__scripts_2plotting__routines_8py_source.html">ipynb_scripts/plotting_routines.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  389</span><span class="keyword">def </span>plot_fRG_V_runs(typ, iK, filenames, NRG_info, labels, run, kind):</div>
<div class="line"><span class="lineno">  390</span>    <span class="keywordflow">if</span> (typ == <span class="stringliteral">&quot;self&quot;</span> <span class="keywordflow">and</span> iK ==0) <span class="keywordflow">or</span> (typ==<span class="stringliteral">&#39;A&#39;</span>):</div>
<div class="line"><span class="lineno">  391</span>        inset = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  392</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  393</span>        inset = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  394</span>        </div>
<div class="line"><span class="lineno">  395</span>    U_NRG = NRG_info[0]</div>
<div class="line"><span class="lineno">  396</span>    path_NRG = NRG_info[1]</div>
<div class="line"><span class="lineno">  397</span>    </div>
<div class="line"><span class="lineno">  398</span>    U_to_ins_ylim  = {0.1: 0.0001, 0.5:0.003, 1:0.008, 1.5: 0.02, 2:0.05, 2.5:0.07, 2.9:0.1, 3:0.1}</div>
<div class="line"><span class="lineno">  399</span>    U_str = <span class="stringliteral">&quot;%.1f&quot;</span> % (2*U_NRG)</div>
<div class="line"><span class="lineno">  400</span> </div>
<div class="line"><span class="lineno">  401</span>    </div>
<div class="line"><span class="lineno">  402</span>    color_dic = {<span class="stringliteral">&#39;K1&#39;</span> : <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">cm.Blues</a>, <span class="stringliteral">&#39;K1_sf&#39;</span> : <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">cm.Oranges</a>, <span class="stringliteral">&#39;K2_1L&#39;</span> : <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">cm.Greens</a>, <span class="stringliteral">&#39;K2_2L&#39;</span> : <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">cm.Reds</a>}</div>
<div class="line"><span class="lineno">  403</span>    title_dic = {<span class="stringliteral">&#39;K1&#39;</span> : <span class="stringliteral">r&#39;$\mathcal{K}_1$ -- &#39;</span> + kind,\</div>
<div class="line"><span class="lineno">  404</span>                 <span class="stringliteral">&#39;K1_sf&#39;</span> : <span class="stringliteral">r&#39;$\mathcal{K}_1$ -sf -- &#39;</span> + kind,\</div>
<div class="line"><span class="lineno">  405</span>                 <span class="stringliteral">&#39;K2_1L&#39;</span> : <span class="stringliteral">r&#39;$\mathcal{K}_2$ 1-L -- &#39;</span> + kind,\</div>
<div class="line"><span class="lineno">  406</span>                 <span class="stringliteral">&#39;K2_2L&#39;</span> : <span class="stringliteral">r&#39;$\mathcal{K}_2$ 2-loop &#39;</span>+<span class="stringliteral">&#39;\n$U/\Delta= &#39;</span>+U_str+<span class="stringliteral">&#39;$&#39;</span>}</div>
<div class="line"><span class="lineno">  407</span>    </div>
<div class="line"><span class="lineno">  408</span>    c = color_dic[run](<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.linspace</a>(0.3,1, <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">len</a>(filenames)))</div>
<div class="line"><span class="lineno">  409</span>    </div>
<div class="line"><span class="lineno">  410</span>    Delta_NRG = 0.5</div>
<div class="line"><span class="lineno">  411</span>    </div>
<div class="line"><span class="lineno">  412</span>    <span class="comment"># load fRG data</span></div>
<div class="line"><span class="lineno">  413</span>    DIAG_CLASS, N_LOOPS, T, epsilon, mu, Gamma, Lambda, Delta, U, V, \</div>
<div class="line"><span class="lineno">  414</span>    v, Sigma, A, \</div>
<div class="line"><span class="lineno">  415</span>    w, K1a, K1p, K1t, \</div>
<div class="line"><span class="lineno">  416</span>    w2, v2, K2a, K2p, K2t \</div>
<div class="line"><span class="lineno">  417</span>        = load_data(U_NRG, Delta_NRG, filenames)</div>
<div class="line"><span class="lineno">  418</span>    </div>
<div class="line"><span class="lineno">  419</span>    K1_dic = {<span class="stringliteral">&#39;K1a&#39;</span>: K1a, <span class="stringliteral">&#39;K1p&#39;</span>: K1p, <span class="stringliteral">&#39;K1t&#39;</span>: K1t}</div>
<div class="line"><span class="lineno">  420</span>    </div>
<div class="line"><span class="lineno">  421</span>    fs = 40 <span class="comment"># font size</span></div>
<div class="line"><span class="lineno">  422</span>    fs_leg = 28</div>
<div class="line"><span class="lineno">  423</span>    fs_ticks = 36</div>
<div class="line"><span class="lineno">  424</span>    fs_ins = 20</div>
<div class="line"><span class="lineno">  425</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">plt.rcParams</a>[<span class="stringliteral">&#39;legend.title_fontsize&#39;</span>] = 34</div>
<div class="line"><span class="lineno">  426</span>    </div>
<div class="line"><span class="lineno">  427</span>    size_a = (15,5)</div>
<div class="line"><span class="lineno">  428</span>    size_twocols = (15,5)</div>
<div class="line"><span class="lineno">  429</span>    </div>
<div class="line"><span class="lineno">  430</span>    lw = 4 <span class="comment">#linewidth</span></div>
<div class="line"><span class="lineno">  431</span>    </div>
<div class="line"><span class="lineno">  432</span>    lw_a = 3</div>
<div class="line"><span class="lineno">  433</span>    fs_a = 26 <span class="comment"># font size</span></div>
<div class="line"><span class="lineno">  434</span>    fs_leg_a = 18</div>
<div class="line"><span class="lineno">  435</span>    fs_ticks_a = fs-4</div>
<div class="line"><span class="lineno">  436</span>    fs_ins_a = fs_leg_a</div>
<div class="line"><span class="lineno">  437</span> </div>
<div class="line"><span class="lineno">  438</span>    </div>
<div class="line"><span class="lineno">  439</span>    ls = [<span class="stringliteral">&#39;dashed&#39;</span>, <span class="stringliteral">&#39;dotted&#39;</span>, <span class="stringliteral">&#39;-.&#39;</span>]</div>
<div class="line"><span class="lineno">  440</span>    </div>
<div class="line"><span class="lineno">  441</span>    temp_dic_U05 = {0: 0.01, 1: 0.05, 2: 0.5}</div>
<div class="line"><span class="lineno">  442</span>    temp_dic_U15 = {0: 0.01, 1: 0.15, 2: 1.5}</div>
<div class="line"><span class="lineno">  443</span>    temp_dic_U25 = {0: 0.01, 1: 0.25, 2: 2.5}</div>
<div class="line"><span class="lineno">  444</span>    </div>
<div class="line"><span class="lineno">  445</span>    temp_dic = {0.5: temp_dic_U05, 1.5: temp_dic_U15, 2.5: temp_dic_U25}</div>
<div class="line"><span class="lineno">  446</span>        </div>
<div class="line"><span class="lineno">  447</span>    <span class="comment">#Plot spectral funciton</span></div>
<div class="line"><span class="lineno">  448</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">if</a>(typ[0]==<span class="stringliteral">&quot;A&quot;</span>):        </div>
<div class="line"><span class="lineno">  449</span>        fig, ax = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">plt.subplots</a>(figsize=size_a)</div>
<div class="line"><span class="lineno">  450</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">plt.rcParams</a>[<span class="stringliteral">&#39;legend.title_fontsize&#39;</span>] = 24</div>
<div class="line"><span class="lineno">  451</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">len</a>(filenames)):        </div>
<div class="line"><span class="lineno">  452</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">ax.plot</a>(v[i]/Delta[i], A[i]*<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.pi</a>*Delta[i], <span class="stringliteral">&#39;.-&#39;</span>, label=labels[i], color=c[i], linewidth=lw_a)</div>
<div class="line"><span class="lineno">  453</span>        <span class="keywordflow">if</span> kind == <span class="stringliteral">&#39;T/U&#39;</span>:</div>
<div class="line"><span class="lineno">  454</span>            <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">len</a>(filenames)):</div>
<div class="line"><span class="lineno">  455</span>                T = temp_dic[U_NRG][i]</div>
<div class="line"><span class="lineno">  456</span>                Tstr = <span class="stringliteral">&quot;%.2f&quot;</span> % T</div>
<div class="line"><span class="lineno">  457</span>                _, w_NRG, Aimp, SE_re, SE_im, _, _, _, _, _, _ = load_SIAM_NRG_finite_T(U_NRG, T ,path_NRG)</div>
<div class="line"><span class="lineno">  458</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">ax.plot</a>(2*w_NRG, Aimp*<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.pi</a>*0.5, linestyle=ls[i], label=Tstr + <span class="stringliteral">&#39;--NRG&#39;</span>, color=<span class="stringliteral">&#39;k&#39;</span>, linewidth=lw_a*0.7)</div>
<div class="line"><span class="lineno">  459</span>            </div>
<div class="line"><span class="lineno">  460</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">ax.hlines</a>(1., -0.5, 0.5, linestyles=<span class="stringliteral">&#39;--&#39;</span>)</div>
<div class="line"><span class="lineno">  461</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">ax.set_ylabel</a>(<span class="stringliteral">r&#39;$\mathcal{A}(\nu)\pi\Delta$&#39;</span>, fontsize=fs_a)</div>
<div class="line"><span class="lineno">  462</span>        </div>
<div class="line"><span class="lineno">  463</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">ax.set_ylim</a>(-0.1, 1.15)</div>
<div class="line"><span class="lineno">  464</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">ax.set_xlim</a>(-5, 5)</div>
<div class="line"><span class="lineno">  465</span>       </div>
<div class="line"><span class="lineno">  466</span>                    </div>
<div class="line"><span class="lineno">  467</span>        <span class="keywordflow">if</span> inset:</div>
<div class="line"><span class="lineno">  468</span>            axins = zoomed_inset_axes(ax, 2.1, loc=2, borderpad = 4.5)</div>
<div class="line"><span class="lineno">  469</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.aspect</a>=<span class="stringliteral">&#39;equal&#39;</span></div>
<div class="line"><span class="lineno">  470</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.hlines</a>(1., -0.5, 0.5, linestyles=<span class="stringliteral">&#39;--&#39;</span>)</div>
<div class="line"><span class="lineno">  471</span>            <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">len</a>(filenames)):</div>
<div class="line"><span class="lineno">  472</span>                T = temp_dic[U_NRG][i]</div>
<div class="line"><span class="lineno">  473</span>                Tstr = <span class="stringliteral">&quot;%.2f&quot;</span> % T</div>
<div class="line"><span class="lineno">  474</span>                _, w_NRG, Aimp, SE_re, SE_im, _, _, _, _, _, _ = load_SIAM_NRG_finite_T(U_NRG, T ,path_NRG)</div>
<div class="line"><span class="lineno">  475</span>                </div>
<div class="line"><span class="lineno">  476</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.plot</a>(v[i]/Delta[i], A[i]*<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.pi</a>*Delta[i], <span class="stringliteral">&#39;.-&#39;</span>, label=labels[i], color=c[i], linewidth=lw_a)</div>
<div class="line"><span class="lineno">  477</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.plot</a>(2*w_NRG, Aimp*<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.pi</a>*0.5, linestyle=ls[i], label=Tstr + <span class="stringliteral">&#39;--NRG&#39;</span>, color=<span class="stringliteral">&#39;k&#39;</span>, linewidth=lw_a*0.7)</div>
<div class="line"><span class="lineno">  478</span>                </div>
<div class="line"><span class="lineno">  479</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.set_ylim</a>(0.9, 1.1)</div>
<div class="line"><span class="lineno">  480</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.set_yticks</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.linspace</a>(0.9, 1.1, 3, endpoint=<span class="keyword">True</span>))    </div>
<div class="line"><span class="lineno">  481</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.set_xlim</a>(-0.4, 0.4)    </div>
<div class="line"><span class="lineno">  482</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.set_xticks</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.linspace</a>(-0.4, 0.4, 3, endpoint=<span class="keyword">True</span>))</div>
<div class="line"><span class="lineno">  483</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.tick_params</a>(axis=<span class="stringliteral">&#39;both&#39;</span>, labelsize=fs_ins)</div>
<div class="line"><span class="lineno">  484</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">plt.xticks</a>(visible=<span class="keyword">True</span>)  <span class="comment"># Present ticks</span></div>
<div class="line"><span class="lineno">  485</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">plt.yticks</a>(visible=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  486</span>            mark_inset(ax, axins, loc1=2, loc2=4, fc=<span class="stringliteral">&quot;none&quot;</span>, ec=<span class="stringliteral">&quot;0.5&quot;</span>)</div>
<div class="line"><span class="lineno">  487</span>    </div>
<div class="line"><span class="lineno">  488</span>        <span class="keywordflow">if</span> kind == <span class="stringliteral">&#39;T/U&#39;</span>:</div>
<div class="line"><span class="lineno">  489</span>            l = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">ax.legend</a>(handles=[], title=title_dic[run], frameon=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  490</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  491</span>            l = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">ax.legend</a>(fontsize=fs_leg_a, title=title_dic[run], frameon=<span class="keyword">False</span>, ncol=2)</div>
<div class="line"><span class="lineno">  492</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">plt.setp</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">l.get_title</a>(), multialignment=<span class="stringliteral">&#39;center&#39;</span>)</div>
<div class="line"><span class="lineno">  493</span>        </div>
<div class="line"><span class="lineno">  494</span> </div>
<div class="line"><span class="lineno">  495</span>        <span class="keywordflow">if</span> U_NRG==2.5 <span class="keywordflow">or</span> kind==<span class="stringliteral">&#39;T/U&#39;</span>:</div>
<div class="line"><span class="lineno">  496</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">ax.set_xlabel</a>(<span class="stringliteral">r&#39;$\nu/\Delta$&#39;</span>, fontsize=fs_a)</div>
<div class="line"><span class="lineno">  497</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">ax.tick_params</a>(axis=<span class="stringliteral">&#39;both&#39;</span>, labelsize=fs_ticks_a)</div>
<div class="line"><span class="lineno">  498</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  499</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">ax.axes.xaxis.set_visible</a>(<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  500</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">ax.tick_params</a>(axis=<span class="stringliteral">&#39;y&#39;</span>, labelsize=fs_ticks_a)</div>
<div class="line"><span class="lineno">  501</span>    </div>
<div class="line"><span class="lineno">  502</span>    <span class="comment">#Plot self energy, component iK</span></div>
<div class="line"><span class="lineno">  503</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">elif</a>(typ[0:4] == <span class="stringliteral">&quot;self&quot;</span>):</div>
<div class="line"><span class="lineno">  504</span>        fig, ax = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">plt.subplots</a>(nrows=1, ncols=2, figsize=size_twocols)</div>
<div class="line"><span class="lineno">  505</span>            </div>
<div class="line"><span class="lineno">  506</span>        <span class="keywordflow">if</span> kind == <span class="stringliteral">&#39;T/U&#39;</span>:</div>
<div class="line"><span class="lineno">  507</span>            <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">len</a>(filenames)):</div>
<div class="line"><span class="lineno">  508</span>                ax[0].<a class="code hl_namespace" href="../../de/d73/namespaceplot.html">plot</a>(v[i]/Delta[i], Sigma[i][iK].real/Delta[i], <span class="stringliteral">&#39;.-&#39;</span>, color=c[i], linewidth=lw)</div>
<div class="line"><span class="lineno">  509</span>                ax[1].<a class="code hl_namespace" href="../../de/d73/namespaceplot.html">plot</a>(v[i]/Delta[i], Sigma[i][iK].imag/Delta[i], <span class="stringliteral">&#39;.-&#39;</span>, color=c[i], linewidth=lw)</div>
<div class="line"><span class="lineno">  510</span>            <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">len</a>(filenames)):</div>
<div class="line"><span class="lineno">  511</span>                T = temp_dic[U_NRG][i]</div>
<div class="line"><span class="lineno">  512</span>                Tstr = <span class="stringliteral">&quot;%.2f&quot;</span> % T</div>
<div class="line"><span class="lineno">  513</span>                _, w_NRG, _, SE_re, SE_im, _, _, _, _, _, _ = load_SIAM_NRG_finite_T(U_NRG, T ,path_NRG)</div>
<div class="line"><span class="lineno">  514</span>                Re_X_NRG = (SE_re - U_NRG / 2) / Delta_NRG</div>
<div class="line"><span class="lineno">  515</span>                Im_X_NRG = SE_im / Delta_NRG</div>
<div class="line"><span class="lineno">  516</span>                <span class="keywordflow">if</span> iK == 1:</div>
<div class="line"><span class="lineno">  517</span>                    Re_X_NRG = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.zeros</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">len</a>(w_NRG/Delta_NRG))</div>
<div class="line"><span class="lineno">  518</span>                    Im_X_NRG = generate_Keldysh_component( Im_X_NRG, w_NRG / Delta_NRG, T, stat=-1)</div>
<div class="line"><span class="lineno">  519</span>            </div>
<div class="line"><span class="lineno">  520</span>                ax[0].<a class="code hl_namespace" href="../../de/d73/namespaceplot.html">plot</a>(w_NRG / Delta_NRG, Re_X_NRG, linestyle=ls[i], color=<span class="stringliteral">&#39;k&#39;</span>, linewidth=lw_a*0.7)</div>
<div class="line"><span class="lineno">  521</span>                ax[1].<a class="code hl_namespace" href="../../de/d73/namespaceplot.html">plot</a>(w_NRG / Delta_NRG, Im_X_NRG, linestyle=ls[i], color=<span class="stringliteral">&#39;k&#39;</span>, linewidth=lw_a*0.7)</div>
<div class="line"><span class="lineno">  522</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  523</span>            <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">len</a>(filenames)):</div>
<div class="line"><span class="lineno">  524</span>                ax[0].<a class="code hl_namespace" href="../../de/d73/namespaceplot.html">plot</a>(v[i]/Delta[i], Sigma[i][iK].real/Delta[i], <span class="stringliteral">&#39;.-&#39;</span>, label=labels[i], color=c[i], linewidth=lw)</div>
<div class="line"><span class="lineno">  525</span>                ax[1].<a class="code hl_namespace" href="../../de/d73/namespaceplot.html">plot</a>(v[i]/Delta[i], Sigma[i][iK].imag/Delta[i], <span class="stringliteral">&#39;.-&#39;</span>, label=labels[i], color=c[i], linewidth=lw)</div>
<div class="line"><span class="lineno">  526</span>            </div>
<div class="line"><span class="lineno">  527</span>        <span class="keywordflow">if</span> inset:</div>
<div class="line"><span class="lineno">  528</span>            axins = zoomed_inset_axes(ax[1], 7, loc=4, borderpad=2.9)</div>
<div class="line"><span class="lineno">  529</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.aspect</a>=<span class="stringliteral">&#39;equal&#39;</span></div>
<div class="line"><span class="lineno">  530</span>            <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">len</a>(filenames)):</div>
<div class="line"><span class="lineno">  531</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.plot</a>(v[i]/Delta[i], Sigma[i][iK].imag/Delta[i], <span class="stringliteral">&#39;.-&#39;</span>, label=labels[i], color=c[i], linewidth=lw)</div>
<div class="line"><span class="lineno">  532</span> </div>
<div class="line"><span class="lineno">  533</span>                _, w_NRG, _, _, SE_im, _, _, _, _, _, _ = load_SIAM_NRG_finite_T(U_NRG, 0.01 ,path_NRG)</div>
<div class="line"><span class="lineno">  534</span>                Im_X_NRG = SE_im / Delta_NRG</div>
<div class="line"><span class="lineno">  535</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.plot</a>(w_NRG / Delta_NRG, Im_X_NRG, linestyle=ls[i], color=<span class="stringliteral">&#39;k&#39;</span>, linewidth=lw_a*0.7)    </div>
<div class="line"><span class="lineno">  536</span>            <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  537</span>                ylim = U_to_ins_ylim[U_NRG]</div>
<div class="line"><span class="lineno">  538</span>            <span class="keywordflow">except</span> KeyError:</div>
<div class="line"><span class="lineno">  539</span>                ylim = U_NRG/20</div>
<div class="line"><span class="lineno">  540</span>                </div>
<div class="line"><span class="lineno">  541</span>                </div>
<div class="line"><span class="lineno">  542</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.set_ylim</a>(-ylim, 0.2*ylim)</div>
<div class="line"><span class="lineno">  543</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.set_yticks</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.linspace</a>(-ylim, 0, 2, endpoint=<span class="keyword">True</span>)) </div>
<div class="line"><span class="lineno">  544</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.yaxis.set_major_formatter</a>(StrMethodFormatter(<span class="stringliteral">&#39;{x:,.2f}&#39;</span>)) <span class="comment"># One decimal place</span></div>
<div class="line"><span class="lineno">  545</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.set_xlim</a>(-0.5, 0.5)    </div>
<div class="line"><span class="lineno">  546</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.set_xticks</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.linspace</a>(-0.5, 0.5, 3, endpoint=<span class="keyword">True</span>))</div>
<div class="line"><span class="lineno">  547</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.tick_params</a>(axis=<span class="stringliteral">&#39;both&#39;</span>, labelsize=fs_ins)</div>
<div class="line"><span class="lineno">  548</span> </div>
<div class="line"><span class="lineno">  549</span>            </div>
<div class="line"><span class="lineno">  550</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">plt.xticks</a>(visible=<span class="keyword">True</span>)  <span class="comment"># Present ticks</span></div>
<div class="line"><span class="lineno">  551</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">plt.yticks</a>(visible=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  552</span>            </div>
<div class="line"><span class="lineno">  553</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">if</a>(iK==0):</div>
<div class="line"><span class="lineno">  554</span>            ax[1].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">hlines</a>(0, -2, 2, linestyles=<span class="stringliteral">&#39;--&#39;</span>)</div>
<div class="line"><span class="lineno">  555</span>            <span class="keywordflow">if</span> inset:</div>
<div class="line"><span class="lineno">  556</span>                <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axins.hlines</a>(0, -2, 2, linestyles=<span class="stringliteral">&#39;--&#39;</span>)</div>
<div class="line"><span class="lineno">  557</span> </div>
<div class="line"><span class="lineno">  558</span>            ax[0].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">set_ylabel</a>(<span class="stringliteral">&#39;$(\mathrm{Re}\Sigma^R-\Sigma^H)/\Delta$&#39;</span>, fontsize=fs+2)</div>
<div class="line"><span class="lineno">  559</span>            ax[1].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">set_ylabel</a>(<span class="stringliteral">&#39;$\mathrm{Im}\Sigma^R/\Delta$&#39;</span>, fontsize=fs+2)</div>
<div class="line"><span class="lineno">  560</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  561</span>            t = ax[0].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">yaxis.get_offset_text</a>()</div>
<div class="line"><span class="lineno">  562</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">t.set_size</a>(fs_leg)</div>
<div class="line"><span class="lineno">  563</span>            ax[0].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">set_ylabel</a>(<span class="stringliteral">&#39;$\mathrm{Re}\Sigma^K/\Delta$&#39;</span>, fontsize=fs+2)</div>
<div class="line"><span class="lineno">  564</span>            ax[1].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">set_ylabel</a>(<span class="stringliteral">&#39;$\mathrm{Im}\Sigma^K/\Delta$&#39;</span>, fontsize=fs+2)</div>
<div class="line"><span class="lineno">  565</span>        </div>
<div class="line"><span class="lineno">  566</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">fig.tight_layout</a>(pad=4)</div>
<div class="line"><span class="lineno">  567</span>            </div>
<div class="line"><span class="lineno">  568</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(2):</div>
<div class="line"><span class="lineno">  569</span>            ax[i].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">set_xlim</a>(-20, 20)</div>
<div class="line"><span class="lineno">  570</span>            <span class="keywordflow">if</span> U_NRG==2.5:</div>
<div class="line"><span class="lineno">  571</span>                ax[i].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">set_xlabel</a>(<span class="stringliteral">r&#39;$\nu/\Delta$&#39;</span>, fontsize=fs+2)</div>
<div class="line"><span class="lineno">  572</span>                ax[i].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">tick_params</a>(axis=<span class="stringliteral">&#39;both&#39;</span>, labelsize=fs_ticks)</div>
<div class="line"><span class="lineno">  573</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  574</span>                ax[i].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">axes.xaxis.set_visible</a>(<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  575</span>                ax[i].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">tick_params</a>(axis=<span class="stringliteral">&#39;y&#39;</span>, labelsize=fs_ticks)</div>
<div class="line"><span class="lineno">  576</span>                </div>
<div class="line"><span class="lineno">  577</span>        <span class="keywordflow">if</span> iK == 1:</div>
<div class="line"><span class="lineno">  578</span>            ax[1].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">yaxis.set_major_formatter</a>(StrMethodFormatter(<span class="stringliteral">&#39;{x:,.1f}&#39;</span>)) <span class="comment"># One decimal place</span></div>
<div class="line"><span class="lineno">  579</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  580</span>            ax[i].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">yaxis.set_major_formatter</a>(StrMethodFormatter(<span class="stringliteral">&#39;{x:,.1f}&#39;</span>)) <span class="comment"># One decimal place</span></div>
<div class="line"><span class="lineno">  581</span>                </div>
<div class="line"><span class="lineno">  582</span>        <span class="keywordflow">if</span> iK == 1:</div>
<div class="line"><span class="lineno">  583</span>            t = ax[0].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">yaxis.get_offset_text</a>()</div>
<div class="line"><span class="lineno">  584</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">t.set_size</a>(fs_leg)</div>
<div class="line"><span class="lineno">  585</span>            l = ax[0].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">legend</a>(title=title_dic[run], fontsize=fs_leg, loc=<span class="stringliteral">&#39;upper left&#39;</span>, ncol=2)</div>
<div class="line"><span class="lineno">  586</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">plt.setp</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">l.get_title</a>(), multialignment=<span class="stringliteral">&#39;center&#39;</span>)</div>
<div class="line"><span class="lineno">  587</span>        </div>
<div class="line"><span class="lineno">  588</span>    </div>
<div class="line"><span class="lineno">  589</span>    <span class="comment">#Plot susceptibilities</span></div>
<div class="line"><span class="lineno">  590</span>    <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">elif</a>(typ[0:4] == <span class="stringliteral">&quot;susc&quot;</span>):    <span class="comment">#susceptibility</span></div>
<div class="line"><span class="lineno">  591</span>        fig, ax = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">plt.subplots</a>(nrows=1, ncols=2, figsize=size_twocols)</div>
<div class="line"><span class="lineno">  592</span>        sup_indices = [<span class="stringliteral">&#39;R&#39;</span>, <span class="stringliteral">&#39;K&#39;</span>]</div>
<div class="line"><span class="lineno">  593</span>        pfs = [-1, +1]</div>
<div class="line"><span class="lineno">  594</span>        susc = typ[5:7]</div>
<div class="line"><span class="lineno">  595</span>        <span class="keywordflow">if</span> susc==<span class="stringliteral">&quot;sp&quot;</span>:      <span class="comment">#spin susceptibility</span></div>
<div class="line"><span class="lineno">  596</span>            <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">len</a>(filenames)):</div>
<div class="line"><span class="lineno">  597</span>                ax[0].<a class="code hl_namespace" href="../../de/d73/namespaceplot.html">plot</a>(w[i] / Delta[i],  K1a[i][iK].real * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.pi</a>* Delta[i],  linestyle=styles[i], label=labels[i], color=c)</div>
<div class="line"><span class="lineno">  598</span>                ax[1].<a class="code hl_namespace" href="../../de/d73/namespaceplot.html">plot</a>(w[i] / Delta[i], pfs[iK]*K1a[i][iK].imag * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.pi</a>* Delta[i],  linestyle=styles[i], label=labels[i], color=c)</div>
<div class="line"><span class="lineno">  599</span>                    </div>
<div class="line"><span class="lineno">  600</span>        <span class="keywordflow">elif</span> susc==<span class="stringliteral">&quot;ch&quot;</span>:        <span class="comment">#charge susceptibility</span></div>
<div class="line"><span class="lineno">  601</span>            <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">len</a>(filenames)):</div>
<div class="line"><span class="lineno">  602</span>                ax[0].<a class="code hl_namespace" href="../../de/d73/namespaceplot.html">plot</a>(w[i] / Delta[i], (2*K1t[i][iK]-K1a[i][iK]).real * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.pi</a>* Delta[i],  linestyle=styles[i], label=labels[i], color=c)</div>
<div class="line"><span class="lineno">  603</span>                ax[1].<a class="code hl_namespace" href="../../de/d73/namespaceplot.html">plot</a>(w[i] / Delta[i], pfs[iK]*(2*K1t[i][iK]-K1a[i][iK]).imag * <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">np.pi</a>* Delta[i],  linestyle=styles[i], label=labels[i], color=c)</div>
<div class="line"><span class="lineno">  604</span>            </div>
<div class="line"><span class="lineno">  605</span>        ax[0].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">set_ylabel</a>(<span class="stringliteral">r&#39;$\mathrm{Re}\chi^&#39;</span>+ sup_indices[iK]+<span class="stringliteral">&#39;_\mathrm{&#39;</span>+susc+<span class="stringliteral">&#39;}\pi\Delta$&#39;</span>, fontsize=fs)</div>
<div class="line"><span class="lineno">  606</span>        ax[1].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">set_ylabel</a>(<span class="stringliteral">r&#39;$\mathrm{Im}\chi^&#39;</span>+ sup_indices[iK]+<span class="stringliteral">&#39;_\mathrm{&#39;</span>+susc+<span class="stringliteral">&#39;}\pi\Delta$&#39;</span>, fontsize=fs)</div>
<div class="line"><span class="lineno">  607</span>        </div>
<div class="line"><span class="lineno">  608</span> </div>
<div class="line"><span class="lineno">  609</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(2):</div>
<div class="line"><span class="lineno">  610</span>            ax[i].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">set_xlabel</a>(<span class="stringliteral">r&#39;$\omega/\Delta$&#39;</span>, fontsize=fs)</div>
<div class="line"><span class="lineno">  611</span>            <span class="keywordflow">if</span> susc == <span class="stringliteral">&#39;sp&#39;</span>:</div>
<div class="line"><span class="lineno">  612</span>                ax[i].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">set_xlim</a>(-5,5)</div>
<div class="line"><span class="lineno">  613</span>            <span class="keywordflow">elif</span> susc == <span class="stringliteral">&#39;ch&#39;</span>:</div>
<div class="line"><span class="lineno">  614</span>                ax[i].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">set_xlim</a>(-10,10)</div>
<div class="line"><span class="lineno">  615</span>            ax[i].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">tick_params</a>(axis=<span class="stringliteral">&#39;both&#39;</span>, labelsize=fs -1)</div>
<div class="line"><span class="lineno">  616</span>        l = ax[0].<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">legend</a>(fontsize=fs, title=title_dic[run])</div>
<div class="line"><span class="lineno">  617</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">plt.setp</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">l.get_title</a>(), multialignment=<span class="stringliteral">&#39;center&#39;</span>)</div>
<div class="line"><span class="lineno">  618</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">fig.tight_layout</a>(pad=3.0)  </div>
<div class="line"><span class="lineno">  619</span>        </div>
<div class="line"><span class="lineno">  620</span>    <span class="keywordflow">return</span> fig, ax</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/dea/bubble__corrections_8hpp_source.html#l00295">correctionFunctionBubble_REG3_Matsubara_PHS_diff()</a>, and <a class="el" href="../../db/de8/ipynb__scripts_2plotting__routines_8py_source.html#l00024">generate_Keldysh_component()</a>.</p>

</div>
</div>
<a id="ab50a9ace2cb6e84d44537ed0579d4aac" name="ab50a9ace2cb6e84d44537ed0579d4aac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab50a9ace2cb6e84d44537ed0579d4aac">&#9670;&#160;</a></span>plot_selfenergy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">plotting_routines.plot_selfenergy </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>filename</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>cnt</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>fs</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*</td>          <td class="paramname"><span class="paramname"><em>args</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/d3d/python__scripts_2plotting__routines_8py_source.html#l00006">6</a> of file <a class="el" href="../../db/d3d/python__scripts_2plotting__routines_8py_source.html">python_scripts/plotting_routines.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">    6</span><span class="keyword">def </span>plot_selfenergy(filename, cnt, fs, *args):</div>
<div class="line"><span class="lineno">    7</span>    iK = int(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">sys.argv</a>[cnt + 1])   <span class="comment"># Keldysh component: 0 = Sigma^R, 1 = Sigma^K</span></div>
<div class="line"><span class="lineno">    8</span>    re = int(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">sys.argv</a>[cnt + 2])   <span class="comment"># 0 = Re(Sigma), 1 = Im(Sigma)</span></div>
<div class="line"><span class="lineno">    9</span>    </div>
<div class="line"><span class="lineno">   10</span>    selfenergy, Lambdas, parameters = load_hdf5(filename, <span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">   11</span>    </div>
<div class="line"><span class="lineno">   12</span>    lines = []</div>
<div class="line"><span class="lineno">   13</span>    leg = []</div>
<div class="line"><span class="lineno">   14</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">   15</span>        args[0]</div>
<div class="line"><span class="lineno">   16</span>    <span class="keywordflow">except</span> IndexError:</div>
<div class="line"><span class="lineno">   17</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">len</a>(Lambdas)):</div>
<div class="line"><span class="lineno">   18</span>            SE, w = rearrange_SE(selfenergy[i], parameters)</div>
<div class="line"><span class="lineno">   19</span>            line, = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">plt.plot</a>(w, SE[iK, re])</div>
<div class="line"><span class="lineno">   20</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">lines.append</a>(line)</div>
<div class="line"><span class="lineno">   21</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">leg.append</a>(<span class="stringliteral">r&#39;$\Lambda=\ $&#39;</span> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">str</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">round</a>(Lambdas[i], 2)))          </div>
<div class="line"><span class="lineno">   22</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">   23</span>        i = args[0]</div>
<div class="line"><span class="lineno">   24</span>        SE, w = rearrange_SE(selfenergy[i], parameters)</div>
<div class="line"><span class="lineno">   25</span>        line, = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">plt.plot</a>(w, SE[iK, re])</div>
<div class="line"><span class="lineno">   26</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">lines.append</a>(line)</div>
<div class="line"><span class="lineno">   27</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">leg.append</a>(<span class="stringliteral">r&#39;$\Lambda=\ $&#39;</span> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">str</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">round</a>(Lambdas[i], 2)))</div>
<div class="line"><span class="lineno">   28</span>    </div>
<div class="line"><span class="lineno">   29</span>    finalize_figure_selfenergy(lines, leg, re, iK, fs)</div>
<div class="line"><span class="lineno">   30</span>    </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/dea/bubble__corrections_8hpp_source.html#l00295">correctionFunctionBubble_REG3_Matsubara_PHS_diff()</a>.</p>

</div>
</div>
<a id="a9c84c11834d1694cb8c8a01f2708c49a" name="a9c84c11834d1694cb8c8a01f2708c49a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c84c11834d1694cb8c8a01f2708c49a">&#9670;&#160;</a></span>plot_spectralfunction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">plotting_routines.plot_spectralfunction </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>filename</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>fs</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*</td>          <td class="paramname"><span class="paramname"><em>args</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/d3d/python__scripts_2plotting__routines_8py_source.html#l00031">31</a> of file <a class="el" href="../../db/d3d/python__scripts_2plotting__routines_8py_source.html">python_scripts/plotting_routines.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   31</span><span class="keyword">def </span>plot_spectralfunction(filename, fs, *args):</div>
<div class="line"><span class="lineno">   32</span>    selfenergy, Lambdas, parameters = load_hdf5(filename, <span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">   33</span>    </div>
<div class="line"><span class="lineno">   34</span>    lines = []</div>
<div class="line"><span class="lineno">   35</span>    leg = []</div>
<div class="line"><span class="lineno">   36</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">   37</span>        args[0]</div>
<div class="line"><span class="lineno">   38</span>    <span class="keywordflow">except</span> IndexError:</div>
<div class="line"><span class="lineno">   39</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">len</a>(Lambdas)):</div>
<div class="line"><span class="lineno">   40</span>            A, w = compute_spectralfunction(selfenergy[i], parameters)</div>
<div class="line"><span class="lineno">   41</span>            line, = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">plt.plot</a>(w, A)</div>
<div class="line"><span class="lineno">   42</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">lines.append</a>(line)</div>
<div class="line"><span class="lineno">   43</span>            <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">leg.append</a>(<span class="stringliteral">r&#39;$\Lambda=\ $&#39;</span> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">str</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">round</a>(Lambdas[i], 2)))</div>
<div class="line"><span class="lineno">   44</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">   45</span>        i = args[0]</div>
<div class="line"><span class="lineno">   46</span>        A, w = compute_spectralfunction(selfenergy[i], parameters)</div>
<div class="line"><span class="lineno">   47</span>        line, = <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">plt.plot</a>(w, A)</div>
<div class="line"><span class="lineno">   48</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">lines.append</a>(line)</div>
<div class="line"><span class="lineno">   49</span>        <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">leg.append</a>(<span class="stringliteral">r&#39;$\Lambda=\ $&#39;</span> + <a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">str</a>(<a class="code hl_function" href="../../dd/dea/bubble__corrections_8hpp.html#aff27784f97591f505f77ff0065ab57af">round</a>(Lambdas[i], 2)))</div>
<div class="line"><span class="lineno">   50</span>        </div>
<div class="line"><span class="lineno">   51</span>    finalize_figure_spectralfunction(lines, leg, fs)</div>
<div class="line"><span class="lineno">   52</span> </div>
<div class="line"><span class="lineno">   53</span> </div>
<div class="line"><span class="lineno">   54</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/dea/bubble__corrections_8hpp_source.html#l00295">correctionFunctionBubble_REG3_Matsubara_PHS_diff()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a1f0c8f313a1e10600e37d7bc975932fa" name="a1f0c8f313a1e10600e37d7bc975932fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f0c8f313a1e10600e37d7bc975932fa">&#9670;&#160;</a></span>family</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">plotting_routines.family</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/de8/ipynb__scripts_2plotting__routines_8py_source.html#l00013">13</a> of file <a class="el" href="../../db/de8/ipynb__scripts_2plotting__routines_8py_source.html">ipynb_scripts/plotting_routines.py</a>.</p>

</div>
</div>
<a id="a0affc5ba7b10820ddde990876f351c5f" name="a0affc5ba7b10820ddde990876f351c5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0affc5ba7b10820ddde990876f351c5f">&#9670;&#160;</a></span>usetex</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">plotting_routines.usetex</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/de8/ipynb__scripts_2plotting__routines_8py_source.html#l00012">12</a> of file <a class="el" href="../../db/de8/ipynb__scripts_2plotting__routines_8py_source.html">ipynb_scripts/plotting_routines.py</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d7/d09/namespaceplotting__routines.html">plotting_routines</a></li>
    <li class="footer">Generated on Thu May 2 2024 15:30:52 for SIAM-Keldysh-mfRG by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
